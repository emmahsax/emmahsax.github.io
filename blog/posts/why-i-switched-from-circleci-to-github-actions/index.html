<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link rel="alternate" href="/feed.xml" type="application/rss+xml">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="manifest" href="/images/favicon/site.webmanifest">
  <link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#001aaf">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/google_fonts.min.css">
  <link rel="stylesheet" href="/css/lightbox.min.css">
  <link rel="stylesheet" href="/css/photoswipe.min.css">
  <link rel="stylesheet" href="/css/site.css">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block" always>
  <meta name="msapplication-config" content="/images/favicon/browserconfig.xml">
  <meta name="msapplication-TileColor" content="#001aaf">

  

  <meta name="theme-color" content="#ffffff">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Switching CircleCI to GitHub Actions | Emma Sax</title>

  <meta name="author" content="Emma Sax">
  <meta property="og:description" content="Read on to learn why I switched from CircleCI to GitHub Actions in order to meet my website&#39;s needs.">
  <meta property="og:locale" content="en-us" />
  <meta property="og:site_name" content="Emma Sax" />
  <meta property="og:title" content="Switching CircleCI to GitHub Actions" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://emmasax.com/blog/posts/why-i-switched-from-circleci-to-github-actions/" />

  <link rel="canonical" href="https://emmasax.com/blog/posts/why-i-switched-from-circleci-to-github-actions/" />
    <meta property="article:published_time" content="2020-05-28T00:00:00-05:00" />

  <meta property="twitter:description" content="Read on to learn why I switched from CircleCI to GitHub Actions in order to meet my website&#39;s needs." />
  <meta name="twitter:card" content="summary" />
  <meta property="twitter:title" content="Switching CircleCI to GitHub Actions" />

  <meta name="google-site-verification" content="FaoWjM_tP-mU4KiPC2szMT0_UQnZrRROCFMUlGgQax8" />
  <meta name="msvalidate.01" content="89B2B19FF966341B78EF64EDADE6DF81" />
  <meta name="yandex-verification" content="32fe10ad6352714a" />
    <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Emma Sax","url":"https://emmasax.com/"},"dateModified":"2025-04-30T12:44:25-05:00","datePublished":"2020-05-28T00:00:00-05:00","description":"Read on to learn why I switched from CircleCI to GitHub Actions in order to meet my website's needs.","headline":"Why I Switched from CircleCI to GitHub Actions","keywords":["tech"],"mainEntityOfPage":{"@id":"https://emmasax.com/blog/posts/why-i-switched-from-circleci-to-github-actions/","@type":"WebPage"},"name":"Emma Sax","url":"https://emmasax.com/blog/posts/why-i-switched-from-circleci-to-github-actions/"}
</script>

</head>
<header class="sticky-top">
  <nav class="navbar navbar-expand-md py-0 py-md-0" data-bs-theme="dark">
    <div class="container-fluid">
      
      <a class="navbar-brand mb-0" href="/" target="_self">
        <img src="/images/logo-plain-white-400.png" width="30" height="30"
          class="d-inline-block align-top nav-icon" alt="E logo"
        >&nbsp;&nbsp;Emma Sax
      </a>

      
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
        data-bs-target="#navbar-links" aria-controls="navbar-links"
        aria-expanded="false" aria-label="Toggle navigation"
      >
        <img class="nav-icon-menu" src="/images/icons/menu.svg" alt="Menu icon">
        <img class="nav-icon-x" src="/images/icons/x.svg" alt="X icon">
      </button>

      
      <div class="collapse navbar-collapse" id="navbar-links">
        <ul class="navbar-nav ms-auto mt-2 mt-md-0">
          <li class="nav-item ">
                <a class="nav-link" href="/about-me/">About Me</a>
              </li>
            <li class="nav-item ">
                <a class="nav-link" href="/interests-and-hobbies/">Interests & Hobbies</a>
              </li>
            <li class="nav-item active">
                <a class="nav-link" href="/blog/">Blog</a>
              </li>
            </ul>
      </div>
    </div>
  </nav>
</header>
<body>
    <main class="container">
      <div class="row">
        <div class="col col-12 col-md-10">
          
          <div class="text-center">
            <h1 class="post-title">
              Why I Switched from CircleCI to GitHub Actions

              <div class="row post-data">
                <div class="col col-12 col-md-4">
                  

                  <span class="post-meta">
                      <picture>
                        <source media="(prefers-color-scheme: dark)" srcset="/images/icons/tag-dark-mode.svg">
                        <img class="post-categorization-icon" src="/images/icons/tag-light-mode.svg" alt="Tag icon">
                      </picture><a href="/blog/tech/">tech</a></span>
                </div>

                <div class="col col-12 col-md-4">
                  <span class="date-meta">May 28, 2020</span></div>

                <div class="col col-12 col-md-4"><span class="post-meta">Read time: 15 minutes</span>
                </div>
              </div>
            </h1>
          </div>

          
          <div class="page-body"><h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#the-decision">The Decision is Made</a></li>
<li><a href="#the-story">The Story Behind this Extreme Decision</a></li>
<li><a href="#how-i-use-ci-tools">How I Use CI Tools</a></li>
<li><a href="#here-enters-github-actions">Here Enters GitHub Actions</a>
<ul>
<li><a href="#building-my-website">1. Building my website</a></li>
<li><a href="#notifying-slack">2. Notifying Slack</a></li>
<li><a href="#deploying-to-github-pages">3. &ldquo;Deploying&rdquo; to GitHub Pages</a></li>
<li><a href="#running-daily-crons">4. Running daily crons</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<div id="anchor">
  <a id="the-decision">&nbsp;</a>
</div>
<h2 id="the-decision-is-made">The Decision is Made</h2>
<p>A couple of months ago, I made a decision to explore CircleCI as a continuous integration (CI) platform. After my exploration, I decided to fully switch over my website from Travis CI to CircleCI. I even wrote <a href="/blog/posts/why-i-switched-from-travis-ci-to-circleci/">a blog post about <em>why</em> I switched from Travis CI to CircleCI</a>. But two months later, although I was still content overall, something happened that made me think about cutting back on dependencies for my site.</p>
<p>I know my website was still dependent on a lot of things: GitHub Pages to serve my site, CircleCI to build and deploy my site, Bootstrap for its buttons and CSS, dependencies for the site&rsquo;s beautiful icons, Jquery for its javascript responsive CSS, etc. So, I made a plan to remove all of those dependencies (crazy, right?!).</p>
<p>If we make the assumption that I&rsquo;ve successfully removed all Bootstrap, Jquery, icons, and Google Fonts dependencies (by downloading them all raw to my GitHub repository&hellip; I know, I&rsquo;m crazy), then I&rsquo;m left with one big gaping dependency hole. My site relies on GitHub and CircleCI. And this leads me to describe what prompted me to do all of this.</p>
<div id="anchor">
  <a id="the-story">&nbsp;</a>
</div>
<h2 id="the-story-behind-this-extreme-decision">The Story Behind this Extreme Decision</h2>
<p>A few weeks ago, Travis CI had a problem delivering notification webhooks. At my work, we send Travis CI webhooks to one of our internal websites, which then sends Slack notifications and starts deployments to our staging and production environments. And when Travis CI stopped sending our webhooks, we lost all notifications and all deployments‚Äîfor half a day.</p>
<p>None of us particularly noticed anything was amiss until a few hours had gone by, and the developers realized none of their code had been deployed to our staging environment. After they reported that to my team, I dove into a two-hour tailspin to figure out why our deployments and notifications never arrived. Did our internal website break? Did notification formats change? Was AWS having blips throughout the day? And what we realized was that the issue wasn&rsquo;t ours‚Äîit was Travis CI&rsquo;s issue.</p>
<p>After we sent Travis CI support an email, they promptly had the issue tracked on their Status Page, and it was fixed within the hour.</p>
<p>At my workplace, at most this was just a few hours&rsquo; time and frustration, and a little bit of slowed down development time; annoying, but recoverable. But it prompted my team to think about how interwoven our development process is with multiple third party platforms. We&rsquo;ve had similar issues when GitHub has outages, since it prevents us from doing code reviews and deployments. Now, it&rsquo;s happened again with our build and testing tool: Travis CI. If AWS started to have issues, then wouldn&rsquo;t be able to run deployments (ignoring the fact that all of our platforms are hosted through AWS).</p>
<p>If any of our development process tools have an outage, then we are unable to develop.</p>
<p>So, how does this relate to my project? After thinking about it for a while, I didn&rsquo;t like how my website was dependent on GitHub <em>and</em> CircleCI. Up until now, CircleCI has only had one half-outage which caused me a little bit of grief. And when I emailed them, their support help was phenomenal. They took responsibility, explained what went wrong, and fixed it right up. But, I thought that it could be worth it to be brave and try something new: <a href="https://github.blog/2019-08-08-github-actions-now-supports-ci-cd/">GitHub Actions</a>.</p>
<p>Up until now, I&rsquo;ve heard of GitHub Actions, but I&rsquo;ve been a little bit scared to try it out. I figured that there was no time like the present to give it a shot. If it doesn&rsquo;t work, then I have a CI solution that I&rsquo;m really perfectly satisfied with and okay sticking with. If it does work out, then I&rsquo;ve got a CI solution I&rsquo;m happy with that <em>also</em> cuts out a third party platform. I won&rsquo;t need to pass secure tokens and secrets around, and I won&rsquo;t need webhooks. GitHub would handle everything, from storing my source code, to building, to deploying, to hosting. And if GitHub has an outage, well my whole site is down anyway, so as long as they&rsquo;re working on fixing it for me, then I&rsquo;m satisfied üëçüèº.</p>
<div id="anchor">
  <a id="how-i-use-ci-tools">&nbsp;</a>
</div>
<h2 id="how-i-use-ci-tools">How I Use CI Tools</h2>
<p>As I originally outlined in <a href="/blog/posts/why-i-switched-from-travis-ci-to-circleci/">my blog post about switching from Travis CI to CircleCI</a>, I use CI tools for four main things:</p>
<blockquote>
<ol>
<li>Build my Jekyll website quickly, run HTML Proofer on it, and have room to grow my test suite if I desire to do so</li>
<li>Notify a Slack channel when the build was done</li>
<li>&ldquo;Deploy&rdquo; my website by making a commit back to my <code>pages</code> branch in GitHub (which GitHub Pages will then deploy for me)</li>
<li>Run a daily cron so that I can automate the build to run whenever I want (ideal for when I&rsquo;d like to publish a blog post at a specific time or to check that my site still builds and loads properly every now and then, since my site doesn&rsquo;t get consistent updates all the time)</li>
</ol></blockquote>
<p>This list of four requirements hasn&rsquo;t changed. CircleCI can do all of these things beautifully, although if I&rsquo;m honest, I had to do some of my own personal fidgeting around to get #3 working as expected and #2 with a custom Slack message. All of this is fine. I put the time and effort in once, and it&rsquo;s paid off countless times since. #automation #computers. Now it&rsquo;s time to see if GitHub Actions can do the same things for me.</p>
<div id="anchor">
  <a id="here-enters-github-actions">&nbsp;</a>
</div>
<h2 id="here-enters-github-actions">Here Enters GitHub Actions</h2>
<p>On the surface, GitHub Actions is <em>very</em> similar to CircleCI. Both of them use Yaml, and both of them use workflows which have multiple jobs, and jobs have multiple steps/commands. Both of them require a <code>checkout</code> step, and both of them have capabilities to run on a schedule or on <code>push</code>.</p>
<p>The immediate first thing I noticed was that GitHub Actions requires you to have a separate file for each workflow. In concept this idea is fine, but this is made 10x worse by the fact that you can&rsquo;t have steps that are shared between jobs/workflows. So each workflow I define must define each job on its own. This is sort of annoying given the fact that my three workflows <code>Develop</code>, <code>Release</code>, and <code>Cron</code> all share nine steps. This means that those three workflow files have <em>a lot</em> of duplicated code on them. This would be cumbersome if I changed my workflow files a lot, so the good news is that I don&rsquo;t forsee them changing every week.</p>
<p>So besides needing a separate workflow file for each workflow, let&rsquo;s jump in to each requirement individually.</p>
<div id="anchor">
  <a id="building-my-website">&nbsp;</a>
</div>
<h3 id="1-building-my-website">1. Building my website</h3>
<p>The first step in each workflow is to <code>checkout</code> the code. GitHub Actions provides a &ldquo;Checkout&rdquo; Action that&rsquo;s made to do exactly that. So there, we have our first few steps:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">job-name</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w"> </span><span class="c"># Linux is the best</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Checkout Code</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># we&#39;ll see the other custom defined environment variables later</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># get the current branch based off github.head_ref OR github.ref (if we&#39;re running this on a branch vs. a PR)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Define Variables</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;::set-env name=BRANCH::$(echo ${{ github.head_ref }} | sed -E &#39;s|refs/[a-zA-Z]+/||&#39;)&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Switch to Current Branch</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">git checkout ${{ env.BRANCH }}</span><span class="w">
</span></span></span></code></pre></div><p>Technically the Checkout Action provides a <code>v2</code> to use, but I found that it doesn&rsquo;t work for what I wanted. I&rsquo;ll explain more about that later. So to bypass those issues, I paired the checkout step with the <code>Switch to Current Branch</code> step to get around that issue.</p>
<p>The next few steps are to set up Bundler, install gems, and build the site. I&rsquo;ll just give these steps instead of explaining:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="c"># install the exact version of bundler that the Gemfile.lock uses</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Configure Bundler</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">sudo gem install bundler -v $(cat Gemfile.lock | tail -1 | tr -d &#39; &#39;)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># use https://github.com/actions/cache to set a gem cache</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Configure Gem Cache</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/cache@v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">vendor/bundle</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l">bundler-cache-${{ hashFiles(&#39;**/Gemfile.lock&#39;) }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restore-keys</span><span class="p">:</span><span class="w"> </span><span class="l">bundler-cache-</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># install all gems or use the cached gems</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Install Gems</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">bundle config set path &#39;vendor/bundle&#39; &amp;&amp; bundle install</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># build the site</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Jekyll Build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">JEKYLL_ENV=production bundle exec jekyll build --destination _site</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># run HTML proofer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">HTML Proofer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">bundle exec htmlproofer --assume-extension --allow-hash-href --internal-domains /https://emmasax.com// --only_4xx _site</span><span class="w">
</span></span></span></code></pre></div><p>Bam! Not too shabby. This now looks <em>very</em> familiar to CircleCI.</p>
<div id="anchor">
  <a id="notifying-slack">&nbsp;</a>
</div>
<h3 id="2-notifying-slack">2. Notifying Slack</h3>
<p>It turns out that GitHub Actions uses actions similarly to how CircleCI uses orbs. So, I went and hunted down the perfect action for slack notifications. I ended up finding <a href="https://github.com/marketplace/actions/action-slacker"><code>action-slacker</code></a>.</p>
<p>Note: Since deciding to use this action, I&rsquo;ve forked my own version of <code>action-slacker</code> and renamed it <code>slack-notifier-action</code>, and made a few changes for my personal usage. Those aren&rsquo;t anything that my readers need to pay attention to, but just know that I use personalized versions of almost all of my actions.</p>
<p>To use <code>action-slacker</code>/<code>slack-notifier-action</code> the way I wanted to, I needed to make two different actions: one runs on successful builds, and the other runs on failed builds. They pass in different messages and colors based on the state of the build:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl">- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Notify Slack on Success</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l">success()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">emmahsax/slack-notifier-action@main</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># I got this from my Slack account and added it as a secret to GitHub</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">SLACK_WEBHOOK</span><span class="p">:</span><span class="w"> </span><span class="l">${{ secrets.SLACK_WEBHOOK }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;#general&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">icon_url</span><span class="p">:</span><span class="w"> </span><span class="l">https://i.imgur.com/DGrghtn.png</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">GitHub Actions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;#23c22e&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">${{ github.repository }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title_link</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/${{ github.repository }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">author_name</span><span class="p">:</span><span class="w"> </span><span class="l">${{ github.actor }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">author_link</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/${{ github.actor }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">author_icon</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/${{ github.actor }}.png</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="p">&gt;-</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      Build &lt;${{ env.BUILD_URL }}|${{ github.run_id }}&gt; on branch `${{ env.BRANCH }}`
</span></span></span><span class="line"><span class="cl"><span class="sd">      in PR &lt;${{ env.PULL_URL }}|#${{ env.PULL_ID }}&gt; *passed*.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Notify Slack on Failure</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l">failure()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">emmahsax/slack-notifier-action@main</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">SLACK_WEBHOOK</span><span class="p">:</span><span class="w"> </span><span class="l">${{ secrets.SLACK_WEBHOOK }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;#general&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">icon_url</span><span class="p">:</span><span class="w"> </span><span class="l">https://i.imgur.com/DGrghtn.png</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">GitHub Actions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;#bd2222&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">${{ github.repository }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title_link</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/${{ github.repository }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">author_name</span><span class="p">:</span><span class="w"> </span><span class="l">${{ github.actor }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">author_link</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/${{ github.actor }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">author_icon</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/${{ github.actor }}.png</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="p">&gt;-</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      Build &lt;${{ env.BUILD_URL }}|${{ github.run_id }}&gt; on branch `${{ env.BRANCH }}`
</span></span></span><span class="line"><span class="cl"><span class="sd">      in PR &lt;${{ env.PULL_URL }}|#${{ env.PULL_ID }}&gt; *failed*.</span><span class="w">
</span></span></span></code></pre></div><p>Ah, I almost forgot&hellip; I missed the new environment variables. By default, <code>BUILD_URL</code>, <code>BRANCH</code>, <code>PULL_URL</code>, and <code>PULL_ID</code> aren&rsquo;t real things. We&rsquo;ve already seen defining <code>BRANCH</code> above. But how about the others? This is how the the rest of the <code>Define Variables</code> step looks:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl">- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Define Variables</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">    pull_id=$(echo ${{ github.ref }} | sed -E &#39;s|refs/pull/||&#39; | sed -E &#39;s|/merge||&#39;)
</span></span></span><span class="line"><span class="cl"><span class="sd">    echo &#34;::set-env name=PULL_ID::$pull_id&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">    echo &#34;::set-env name=PULL_URL::$(echo https://github.com/${{ github.repository }}/pull/$pull_id)&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">    echo &#34;::set-env name=BUILD_URL::$(echo https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }})&#34;</span><span class="w">
</span></span></span></code></pre></div><p>And that&rsquo;s it. Add those few steps, and now one of the slack steps will always run, depending on the rest of the build.</p>
<div id="anchor">
  <a id="deploying-to-github-pages">&nbsp;</a>
</div>
<h3 id="3-deploying-to-github-pages">3. &ldquo;Deploying&rdquo; to GitHub Pages</h3>
<p>With GitHub Actions&rsquo; marketplace, it made it simple to find the perfect action to &ldquo;deploy&rdquo; to GitHub Pages: <a href="https://github.com/marketplace/actions/deploy-to-github-pages"><code>Deploy to GitHub Pages</code></a>. This action was ideal, since it didn&rsquo;t require me to pass a lot of environment variables or inputs in to get it working correctly. Here&rsquo;s what I needed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl">- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">GitHub Pages Deploy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">emmahsax/github-pages-deploy-action@main</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l">${{ secrets.GITHUB_TOKEN }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">BRANCH</span><span class="p">:</span><span class="w"> </span><span class="l">pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">FOLDER</span><span class="p">:</span><span class="w"> </span><span class="l">_site</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">CLEAN</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">COMMIT_MESSAGE</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Deploy to ${{ github.repository }}.git:pages&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">GIT_CONFIG_EMAIL</span><span class="p">:</span><span class="w"> </span><span class="m">41898282</span><span class="l">+github-actions[bot]@users.noreply.github.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">GIT_CONFIG_NAME</span><span class="p">:</span><span class="w"> </span><span class="l">github-actions[bot]</span><span class="w">
</span></span></span></code></pre></div><p>The <code>${{ secrets.GITHUB_TOKEN }}</code> is something that&rsquo;s built into GitHub Actions, and is automatically provided with exactly the permissions required, so there was no passing around of permissions or tokens to obtain this.</p>
<p>The <code>CLEAN: true</code> was something that I added in later, when I realized that without it, deleted directories wouldn&rsquo;t be automatically deleted from my <code>pages</code> branch. One other thing that I had to take note of was that for some reason, the deploy wouldn&rsquo;t work properly with <code>actions/checkout@v2</code> (it rewrites the files upon deploy, meaning each page on my site would receive a new <code>updated_at</code> or <code>lastModifiedAt</code> date upon each deploy), so I switched to <code>actions/checkout@v1</code>. Of course, <code>v1</code> of the checkout step had its own cross to bear, but that was fine for me to compromise with. I think that I could&rsquo;ve gotten <code>v2</code> to work properly, had I finished reading the documentation for the deploy action originally.</p>
<p>One super cool thing that I actually suggested to the author of this action was to have a deployment status that is outputted at the end of the whole thing. It&rsquo;s described a bit in <a href="https://github.com/marketplace/actions/deploy-to-github-pages#deployment-status">the formal documentation</a>, but with this, I was able to custom create a Slack message specifically about the deployment:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl">- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Set Deploy Status Message</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">    if [[ ${{ env.DEPLOYMENT_STATUS }} == skipped ]]; then
</span></span></span><span class="line"><span class="cl"><span class="sd">      echo &#34;::set-env name=DEPLOY_MESSAGE::$(echo Deploy to GitHub Pages was *skipped*)&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">    elif [[ ${{ env.DEPLOYMENT_STATUS }} == success ]]; then
</span></span></span><span class="line"><span class="cl"><span class="sd">      echo &#34;::set-env name=DEPLOY_MESSAGE::$(echo Deploy to GitHub Pages was *successful*)&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">    elif [[ ${{ env.DEPLOYMENT_STATUS }} == failed ]]; then
</span></span></span><span class="line"><span class="cl"><span class="sd">      echo &#34;::set-env name=DEPLOY_MESSAGE::$(echo Deploy to GitHub Pages was *unsuccessful*)&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">    fi</span><span class="w">
</span></span></span></code></pre></div><p>And then I can call that new message by using this: <code>${{ env.DEPLOY_MESSAGE }}</code>.</p>
<p>Important note: when using the generic version of this action, you&rsquo;ll need to pass the <code>GITHUB_TOKEN</code> as a <code>with</code> variable instead of an <code>env</code> variable; I have a specific version of this action that takes it in as an <code>env</code> variable.</p>
<div id="anchor">
  <a id="running-daily-crons">&nbsp;</a>
</div>
<h3 id="4-running-daily-crons">4. Running daily crons</h3>
<p>If I&rsquo;m completely honest, running daily crons is about the simplest part of this entire process. Either GitHub Actions supports crons, or it doesn&rsquo;t. In this case&hellip; it totally does. The <a href="https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions#onschedule">documentation for GitHub Actions schedules</a> clearly defines that we should submit our crons in UTC in Posix format:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Cron</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">schedule</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">cron: &#39;30 5 * * 1&#39; # On Mondays</span><span class="p">:</span><span class="w"> </span><span class="m">05</span><span class="p">:</span><span class="m">30</span><span class="w"> </span><span class="l">UTC =&gt; 00:30 CDT / 23:30 CST</span><span class="w">
</span></span></span></code></pre></div><p>And that&rsquo;s it. The cron takes a couple of minutes longer to begin than it does with CircleCI, but that&rsquo;s close enough for me.</p>
<div id="anchor">
  <a id="conclusion">&nbsp;</a>
</div>
<h2 id="conclusion">Conclusion</h2>
<p>After what&rsquo;s probably about 8 hours of work, my new CI solution is complete. My site now completely uses GitHub Actions to build and deploy, and there&rsquo;s only a couple things I compromised.</p>
<ol>
<li>Builds take little bit longer (maybe 30 seconds longer&hellip; still shorter than with Travis CI)</li>
<li>More lines of duplicated workflow code</li>
<li>Crons don&rsquo;t exactly start on the dot&hellip; they make take about 2 minutes to be triggered (still better than the 1 hour that Travis CI warned about)</li>
</ol>
<p>But these cons are worth it, given that my site now completely runs on GitHub Actions and doesn&rsquo;t need any other tooling.</p>
<p>If somebody were to ask me whether to use GitHub Actions, Travis CI, or CircleCI, I&rsquo;d give different responses based on the use case. If the person wants something supported, familiar, and common, then I&rsquo;d say to use Travis CI. In an enterprise setting, Travis CI probably has some of the best abilities to connect to AWS, Heroku, Jenkins, etc. If the person wants something that&rsquo;s still formally supported, and potentially willing to try new things, then CircleCI may be the way to go. It&rsquo;s fast, simple, and relatively easy to use (if you are willing to make additional bash scripts). And if the person wants something natively built into GitHub, is okay duplicating some code, and is willing to poke around more open source code, then GitHub Actions can be a powerful tool. Also, with either Travis CI or GitHub Actions, if you don&rsquo;t want builds running on a few select branches, you don&rsquo;t need to explicitly ignore them, like with CircleCI. It&rsquo;s worth noting that for all three of these CI solutions, you&rsquo;ll have to start spending money if you want to use them heavily with private repositories.</p>
<p>And as for me, I think I&rsquo;m going to have to cut myself off from new CI solutions for now. GitHub Actions does everything I want it to, and now that it&rsquo;s all set up, it&rsquo;s fast, easy to maintain, and of course, I&rsquo;ve got that one big bonus&hellip; I&rsquo;ve eliminated a third party development dependency.</p>

              <div class="text-center margin-bottom-1">
                <button id="show-comments-button" class="btn btn-lg btn-outline button-text">
                  Load Comments
                </button>

                <script id="comments" data-name="emmasax4" src="/js/show_comments.js"></script>
              </div>

              <div id="disqus_thread"></div>

              <noscript>
                Please enable JavaScript to view the
                <a href="https://disqus.com/?ref_noscript" rel="nofollow">
                  comments powered by Disqus.
                </a>
              </noscript>
          </div>
        </div>

        <div class="col col-12 col-md-2">
          
          <div class="text-center">
            <div class="padding-bottom-1">
  <a href="/blog/" class="btn btn-lg btn-outline button-text">Blog Posts</a>
</div>

            <a href="/feed.xml" target="_blank" class="link-icon-rss">
  <img class="icon-hover-dark-mode" src="/images/icons/rss-hover-dark-mode.svg" alt="RSS icon">
  <img class="icon-hover-light-mode" src="/images/icons/rss-hover-light-mode.svg" alt="RSS icon">
  <img class="icon-static-dark-mode" src="/images/icons/rss-static-dark-mode.svg" alt="RSS icon">
  <img class="icon-static-light-mode" src="/images/icons/rss-static-light-mode.svg" alt="RSS icon">
</a>


          </div>
        </div>
      </div>
    </main>
  </body>

  <footer>
  &copy; <span id="year"></span>
  Emma Sax. All rights reserved.
</footer>
<script
  child-selector=".photoswipe"
  class="photoswipe-activation"
  gallery-selector=".photoswipe-gallery"
  src="/js/activate_photoswipe.js"
  type="module"
></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/external_links.js"></script>
<script src="/js/full_year.js"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/lightbox.min.js"></script>
</html>
