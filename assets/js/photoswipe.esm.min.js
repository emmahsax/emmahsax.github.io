// From https://github.com/dimsemenov/PhotoSwipe

/*!
  * PhotoSwipe 5.2.1 - https://photoswipe.com
  * (c) 2022 Dmytro Semenov
*/

function createElement(b,d,c){let a=document.createElement(d||"div");return b&&(a.className=b),c&&c.appendChild(a),a}function equalizePoints(a,b){return a.x=b.x,a.y=b.y,void 0!==b.id&&(a.id=b.id),a}function roundPoint(a){a.x=Math.round(a.x),a.y=Math.round(a.y)}function getDistanceBetween(a,b){let c=Math.abs(a.x-b.x),d=Math.abs(a.y-b.y);return Math.sqrt(c*c+d*d)}function pointsEqual(a,b){return a.x===b.x&&a.y===b.y}function clamp(a,b,c){return Math.min(Math.max(a,b),c)}function toTransformString(c,d,a){let b="translate3d("+c+"px,"+(d||0)+"px,0)";return void 0!==a&&(b+=" scale3d("+a+","+a+",1)"),b}function setTransform(a,b,c,d){a.style.transform=toTransformString(b,c,d)}let defaultCSSEasing="cubic-bezier(.4,0,.22,1)";function setTransitionStyle(b,a,c,d){b.style.transition=a?a+" "+c+"ms "+(d||"cubic-bezier(.4,0,.22,1)"):"none"}function setWidthHeight(c,a,b){c.style.width="number"==typeof a?a+"px":a,c.style.height="number"==typeof b?b+"px":b}function removeTransitionStyle(a){setTransitionStyle(a)}function decodeImage(a){return"decode"in a?a.decode():a.complete?Promise.resolve(a):new Promise((c,b)=>{a.onload=()=>c(a),a.onerror=b})}let LOAD_STATE={IDLE:"idle",LOADING:"loading",LOADED:"loaded",ERROR:"error"};function specialKeyUsed(a){if(2===a.which||a.ctrlKey||a.metaKey||a.altKey||a.shiftKey)return!0}function getElementsFromOption(a,d,e=document){let b=[];if(a instanceof Element)b=[a];else if(a instanceof NodeList||Array.isArray(a))b=Array.from(a);else{let c="string"==typeof a?a:d;c&&(b=Array.from(e.querySelectorAll(c)))}return b}let supportsPassive=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get(){supportsPassive=!0}}))}catch(a){}class DOMEvents{constructor(){this._pool=[]}add(a,b,c,d){this._toggleListener(a,b,c,d)}remove(a,b,c,d){this._toggleListener(a,b,c,d,!0)}removeAll(){this._pool.forEach(a=>{this._toggleListener(a.target,a.type,a.listener,a.passive,!0,!0)}),this._pool=[]}_toggleListener(b,a,d,e,c,f){if(!b)return;let g=(c?"remove":"add")+"EventListener";(a=a.split(" ")).forEach(a=>{if(a){f||(c?this._pool=this._pool.filter(c=>c.type!==a||c.listener!==d||c.target!==b):this._pool.push({target:b,type:a,listener:d,passive:e}));let h=!!supportsPassive&&{passive:e||!1};b[g](a,d,h)}})}}function getViewportSize(a,c){if(a.getViewportSizeFn){let b=a.getViewportSizeFn(a,c);if(b)return b}return{x:document.documentElement.clientWidth,y:window.innerHeight}}function parsePaddingOption(b,a,e,f,g){let c;if(a.paddingFn)c=a.paddingFn(e,f,g)[b];else if(a.padding)c=a.padding[b];else{let d="padding"+b[0].toUpperCase()+b.slice(1);a[d]&&(c=a[d])}return c||0}function getPanAreaSize(b,a,c,d){return{x:a.x-parsePaddingOption("left",b,a,c,d)-parsePaddingOption("right",b,a,c,d),y:a.y-parsePaddingOption("top",b,a,c,d)-parsePaddingOption("bottom",b,a,c,d)}}class PanBounds{constructor(a){this.slide=a,this.currZoomLevel=1,this.center={},this.max={},this.min={},this.reset()}update(a){this.currZoomLevel=a,this.slide.width?(this._updateAxis("x"),this._updateAxis("y"),this.slide.pswp.dispatch("calcBounds",{slide:this.slide})):this.reset()}_updateAxis(a){let{pswp:e}=this.slide,b=this.slide["x"===a?"width":"height"]*this.currZoomLevel,d=parsePaddingOption("x"===a?"left":"top",e.options,e.viewportSize,this.slide.data,this.slide.index),c=this.slide.panAreaSize[a];this.center[a]=Math.round((c-b)/2)+d,this.max[a]=b>c?Math.round(c-b)+d:this.center[a],this.min[a]=b>c?d:this.center[a]}reset(){this.center.x=0,this.center.y=0,this.max.x=0,this.max.y=0,this.min.x=0,this.min.y=0}correctPan(a,b){return clamp(b,this.max[a],this.min[a])}}let MAX_IMAGE_WIDTH=4e3;class ZoomLevel{constructor(a,b,c,d){this.pswp=d,this.options=a,this.itemData=b,this.index=c}update(c,d,e){this.elementSize={x:c,y:d},this.panAreaSize=e;let b=this.panAreaSize.x/this.elementSize.x,a=this.panAreaSize.y/this.elementSize.y;this.fit=Math.min(1,b<a?b:a),this.fill=Math.min(1,b>a?b:a),this.vFill=Math.min(1,a),this.initial=this._getInitial(),this.secondary=this._getSecondary(),this.max=Math.max(this.initial,this.secondary,this._getMax()),this.min=Math.min(this.fit,this.initial,this.secondary),this.pswp&&this.pswp.dispatch("zoomLevelsUpdate",{zoomLevels:this,slideData:this.itemData})}_parseZoomLevelOption(b){let a=this.options[b+"ZoomLevel"];return a?"function"==typeof a?a(this):"fill"===a?this.fill:"fit"===a?this.fit:Number(a):void 0}_getSecondary(){let a=this._parseZoomLevelOption("secondary");return a||(a=Math.min(1,3*this.fit))*this.elementSize.x>4e3&&(a=4e3/this.elementSize.x),a}_getInitial(){return this._parseZoomLevelOption("initial")||this.fit}_getMax(){let a=this._parseZoomLevelOption("max");return a||Math.max(1,4*this.fit)}}class Slide{constructor(c,b,a){this.data=c,this.index=b,this.pswp=a,this.isActive=b===a.currIndex,this.currentResolution=0,this.panAreaSize={},this.isFirstSlide=this.isActive&&!a.opener.isOpen,this.zoomLevels=new ZoomLevel(a.options,c,b,a),this.pswp.dispatch("gettingData",{slide:this,data:this.data,index:b}),this.pan={x:0,y:0},this.content=this.pswp.contentLoader.getContentBySlide(this),this.container=createElement("pswp__zoom-wrap"),this.currZoomLevel=1,this.width=this.content.width,this.height=this.content.height,this.bounds=new PanBounds(this),this.prevDisplayedWidth=-1,this.prevDisplayedHeight=-1,this.pswp.dispatch("slideInit",{slide:this})}setIsActive(a){a&&!this.isActive?this.activate():!a&&this.isActive&&this.deactivate()}append(a){if(this.holderElement=a,!this.data){this.holderElement.innerHTML="";return}this.calculateSize(),this.container.transformOrigin="0 0",this.load(),this.appendHeavy(),this.updateContentSize(),this.holderElement.innerHTML="",this.holderElement.appendChild(this.container),this.zoomAndPanToInitial(),this.pswp.dispatch("firstZoomPan",{slide:this}),this.applyCurrentZoomPan(),this.pswp.dispatch("afterSetContent",{slide:this}),this.isActive&&this.activate()}load(){this.content.load(),this.pswp.dispatch("slideLoad",{slide:this})}appendHeavy(){let{pswp:a}=this;this.heavyAppended||!a.opener.isOpen||a.mainScroll.isShifted()||!this.isActive||this.pswp.dispatch("appendHeavy",{slide:this}).defaultPrevented||(this.heavyAppended=!0,this.content.append(),this.pswp.dispatch("appendHeavyContent",{slide:this}))}activate(){this.isActive=!0,this.appendHeavy(),this.content.activate(),this.pswp.dispatch("slideActivate",{slide:this})}deactivate(){this.isActive=!1,this.content.deactivate(),this.currentResolution=0,this.zoomAndPanToInitial(),this.applyCurrentZoomPan(),this.updateContentSize(),this.pswp.dispatch("slideDeactivate",{slide:this})}destroy(){this.content.hasSlide=!1,this.content.remove(),this.pswp.dispatch("slideDestroy",{slide:this})}resize(){this.currZoomLevel!==this.zoomLevels.initial&&this.isActive?(this.calculateSize(),this.bounds.update(this.currZoomLevel),this.panTo(this.pan.x,this.pan.y)):(this.calculateSize(),this.currentResolution=0,this.zoomAndPanToInitial(),this.applyCurrentZoomPan(),this.updateContentSize())}updateContentSize(d){let a=this.currentResolution||this.zoomLevels.initial;if(!a)return;let b=Math.round(this.width*a)||this.pswp.viewportSize.x,c=Math.round(this.height*a)||this.pswp.viewportSize.y;(this.sizeChanged(b,c)||d)&&this.content.setDisplayedSize(b,c)}sizeChanged(a,b){return(a!==this.prevDisplayedWidth||b!==this.prevDisplayedHeight)&&(this.prevDisplayedWidth=a,this.prevDisplayedHeight=b,!0)}getPlaceholderElement(){if(this.content.placeholder)return this.content.placeholder.element}zoomTo(b,c,d,g){let{pswp:a}=this;if(!this.isZoomable()||a.mainScroll.isShifted())return;a.dispatch("beforeZoomTo",{destZoomLevel:b,centerPoint:c,transitionDuration:d}),a.animations.stopAllPan();let e=this.currZoomLevel;g||(b=clamp(b,this.zoomLevels.min,this.zoomLevels.max)),this.setZoomLevel(b),this.pan.x=this.calculateZoomToPanOffset("x",c,e),this.pan.y=this.calculateZoomToPanOffset("y",c,e),roundPoint(this.pan);let f=()=>{this._setResolution(b),this.applyCurrentZoomPan()};d?a.animations.startTransition({isPan:!0,name:"zoomTo",target:this.container,transform:this.getCurrentTransform(),onComplete:f,duration:d,easing:a.options.easing}):f()}toggleZoom(a){this.zoomTo(this.currZoomLevel===this.zoomLevels.initial?this.zoomLevels.secondary:this.zoomLevels.initial,a,this.pswp.options.zoomAnimationDuration)}setZoomLevel(a){this.currZoomLevel=a,this.bounds.update(this.currZoomLevel)}calculateZoomToPanOffset(a,b,c){let d=this.bounds.max[a]-this.bounds.min[a];if(0===d)return this.bounds.center[a];b||(b=this.pswp.getViewportCenterPoint());let e=this.currZoomLevel/c;return this.bounds.correctPan(a,(this.pan[a]-b[a])*e+b[a])}panTo(a,b){this.pan.x=this.bounds.correctPan("x",a),this.pan.y=this.bounds.correctPan("y",b),this.applyCurrentZoomPan()}isPannable(){return this.width&&this.currZoomLevel>this.zoomLevels.fit}isZoomable(){return this.width&&this.content.isZoomable()}applyCurrentZoomPan(){this._applyZoomTransform(this.pan.x,this.pan.y,this.currZoomLevel),this===this.pswp.currSlide&&this.pswp.dispatch("zoomPanUpdate",{slide:this})}zoomAndPanToInitial(){this.currZoomLevel=this.zoomLevels.initial,this.bounds.update(this.currZoomLevel),equalizePoints(this.pan,this.bounds.center),this.pswp.dispatch("initialZoomPan",{slide:this})}_applyZoomTransform(b,c,a){a/=this.currentResolution||this.zoomLevels.initial,setTransform(this.container,b,c,a)}calculateSize(){let{pswp:a}=this;equalizePoints(this.panAreaSize,getPanAreaSize(a.options,a.viewportSize,this.data,this.index)),this.zoomLevels.update(this.width,this.height,this.panAreaSize),a.dispatch("calcSlideSize",{slide:this})}getCurrentTransform(){let a=this.currZoomLevel/(this.currentResolution||this.zoomLevels.initial);return toTransformString(this.pan.x,this.pan.y,a)}_setResolution(a){a!==this.currentResolution&&(this.currentResolution=a,this.updateContentSize(),this.pswp.dispatch("resolutionChanged"))}}let PAN_END_FRICTION=.35,VERTICAL_DRAG_FRICTION=.6,MIN_RATIO_TO_CLOSE=.4,MIN_NEXT_SLIDE_SPEED=.5;function project(b,a){return b*a/(1-a)}class DragHandler{constructor(a){this.gestures=a,this.pswp=a.pswp,this.startPan={}}start(){equalizePoints(this.startPan,this.pswp.currSlide.pan),this.pswp.animations.stopAll()}change(){let{p1:d,prevP1:e,dragAxis:f,pswp:b}=this.gestures,{currSlide:a}=b;if("y"===f&&b.options.closeOnVerticalDrag&&a.currZoomLevel<=a.zoomLevels.fit&&!this.gestures.isMultitouch){let c=a.pan.y+(d.y-e.y);if(!b.dispatch("verticalDrag",{panY:c}).defaultPrevented){this._setPanWithFriction("y",c,.6);let g=1-Math.abs(this._getVerticalDragRatio(a.pan.y));b.applyBgOpacity(g),a.applyCurrentZoomPan()}}else{let h=this._panOrMoveMainScroll("x");h||(this._panOrMoveMainScroll("y"),roundPoint(a.pan),a.applyCurrentZoomPan())}}end(){let{pswp:b,velocity:a}=this.gestures,{mainScroll:c}=b,e=0;if(b.animations.stopAll(),c.isShifted()){let f=c.x-c.getCurrSlideX(),d=f/b.viewportSize.x;a.x< -0.5&&d<0||a.x<.1&&d< -0.5?(e=1,a.x=Math.min(a.x,0)):(a.x>.5&&d>0||a.x> -0.1&&d>.5)&&(e=-1,a.x=Math.max(a.x,0)),c.moveIndexBy(e,!0,a.x)}b.currSlide.currZoomLevel>b.currSlide.zoomLevels.max||this.gestures.isMultitouch?this.gestures.zoomLevels.correctZoomPan(!0):(this._finishPanGestureForAxis("x"),this._finishPanGestureForAxis("y"))}_finishPanGestureForAxis(a){let{pswp:b}=this,{currSlide:i}=b,{velocity:f}=this.gestures,{pan:j,bounds:k}=i,c=j[a],l=b.bgOpacity<1&&"y"===a,e=c+project(f[a],.995);if(l){let g=this._getVerticalDragRatio(c),h=this._getVerticalDragRatio(e);if(g<0&&h< -0.4||g>0&&h>.4){b.close();return}}let d=k.correctPan(a,e);if(c===d)return;let m=b.bgOpacity,n=d-c;b.animations.startSpring({name:"panGesture"+a,isPan:!0,start:c,end:d,velocity:f[a],dampingRatio:d===e?1:.82,onUpdate(c){if(l&&b.bgOpacity<1){let e=1-(d-c)/n;b.applyBgOpacity(clamp(m+(1-m)*e,0,1))}j[a]=Math.floor(c),i.applyCurrentZoomPan()}})}_panOrMoveMainScroll(a){let{p1:m,pswp:j,dragAxis:n,prevP1:o,isMultitouch:k}=this.gestures,{currSlide:g,mainScroll:b}=j,f=m[a]-o[a],e=b.x+f;if(!f)return;if("x"===a&&!g.isPannable()&&!k)return b.moveTo(e,!0),!0;let{bounds:c}=g,d=g.pan[a]+f;if(j.options.allowPanToNext&&"x"===n&&"x"===a&&!k){let h=b.getCurrSlideX(),i=b.x-h,l=f>0,p=!l;if(d>c.min[a]&&l){let q=c.min[a]<=this.startPan[a];if(q)return b.moveTo(e,!0),!0;this._setPanWithFriction(a,d)}else if(d<c.max[a]&&p){let r=this.startPan[a]<=c.max[a];if(r)return b.moveTo(e,!0),!0;this._setPanWithFriction(a,d)}else if(0!==i){if(i>0)return b.moveTo(Math.max(e,h),!0),!0;if(i<0)return b.moveTo(Math.min(e,h),!0),!0}else this._setPanWithFriction(a,d)}else"y"===a&&(b.isShifted()||c.min.y===c.max.y)||this._setPanWithFriction(a,d)}_getVerticalDragRatio(a){return(a-this.pswp.currSlide.bounds.center.y)/(this.pswp.viewportSize.y/3)}_setPanWithFriction(a,b,d){let{pan:c,bounds:e}=this.pswp.currSlide,f=e.correctPan(a,b);if(f!==b||d){let g=Math.round(b-c[a]);c[a]+=g*(d||.35)}else c[a]=b}}let UPPER_ZOOM_FRICTION=.05,LOWER_ZOOM_FRICTION=.15;function getZoomPointsCenter(a,b,c){return a.x=(b.x+c.x)/2,a.y=(b.y+c.y)/2,a}class ZoomHandler{constructor(a){this.gestures=a,this.pswp=this.gestures.pswp,this._startPan={},this._startZoomPoint={},this._zoomPoint={}}start(){this._startZoomLevel=this.pswp.currSlide.currZoomLevel,equalizePoints(this._startPan,this.pswp.currSlide.pan),this.pswp.animations.stopAllPan(),this._wasOverFitZoomLevel=!1}change(){let{p1:f,startP1:g,p2:h,startP2:i,pswp:c}=this.gestures,{currSlide:b}=c,d=b.zoomLevels.min,e=b.zoomLevels.max;if(!b.isZoomable()||c.mainScroll.isShifted())return;getZoomPointsCenter(this._startZoomPoint,g,i),getZoomPointsCenter(this._zoomPoint,f,h);let a=1/getDistanceBetween(g,i)*getDistanceBetween(f,h)*this._startZoomLevel;if(a>b.zoomLevels.initial+b.zoomLevels.initial/15&&(this._wasOverFitZoomLevel=!0),a<d){if(c.options.pinchToClose&&!this._wasOverFitZoomLevel&&this._startZoomLevel<=b.zoomLevels.initial){let j=1-(d-a)/(d/1.2);c.dispatch("pinchClose",{bgOpacity:j}).defaultPrevented||c.applyBgOpacity(j)}else a=d-(d-a)*.15}else a>e&&(a=e+(a-e)*.05);b.pan.x=this._calculatePanForZoomLevel("x",a),b.pan.y=this._calculatePanForZoomLevel("y",a),b.setZoomLevel(a),b.applyCurrentZoomPan()}end(){let{pswp:a}=this,{currSlide:b}=a;b.currZoomLevel<b.zoomLevels.initial&&!this._wasOverFitZoomLevel&&a.options.pinchToClose?a.close():this.correctZoomPan()}_calculatePanForZoomLevel(a,b){let c=b/this._startZoomLevel;return this._zoomPoint[a]-(this._startZoomPoint[a]-this._startPan[a])*c}correctZoomPan(h){let{pswp:c}=this,{currSlide:a}=c;if(!a.isZoomable())return;void 0===this._zoomPoint.x&&(h=!0);let d=a.currZoomLevel,b,f=!0;d<a.zoomLevels.initial?b=a.zoomLevels.initial:d>a.zoomLevels.max?b=a.zoomLevels.max:(f=!1,b=d);let k=c.bgOpacity,j=c.bgOpacity<1,g=equalizePoints({},a.pan),e=equalizePoints({},g);h&&(this._zoomPoint.x=0,this._zoomPoint.y=0,this._startZoomPoint.x=0,this._startZoomPoint.y=0,this._startZoomLevel=d,equalizePoints(this._startPan,g)),f&&(e={x:this._calculatePanForZoomLevel("x",b),y:this._calculatePanForZoomLevel("y",b)}),a.setZoomLevel(b),e={x:a.bounds.correctPan("x",e.x),y:a.bounds.correctPan("y",e.y)},a.setZoomLevel(d);let i=!0;if(pointsEqual(e,g)&&(i=!1),!i&&!f&&!j){a._setResolution(b),a.applyCurrentZoomPan();return}c.animations.stopAllPan(),c.animations.startSpring({isPan:!0,start:0,end:1e3,velocity:0,dampingRatio:1,naturalFrequency:40,onUpdate(h){if(h/=1e3,i||f){if(i&&(a.pan.x=g.x+(e.x-g.x)*h,a.pan.y=g.y+(e.y-g.y)*h),f){let l=d+(b-d)*h;a.setZoomLevel(l)}a.applyCurrentZoomPan()}j&&c.bgOpacity<1&&c.applyBgOpacity(clamp(k+(1-k)*h,0,1))},onComplete(){a._setResolution(b),a.applyCurrentZoomPan()}})}}function didTapOnMainContent(a){return!!a.target.closest(".pswp__container")}class TapHandler{constructor(a){this.gestures=a}click(c,a){let b=a.target.classList,d=b.contains("pswp__img"),e=b.contains("pswp__item")||b.contains("pswp__zoom-wrap");d?this._doClickOrTapAction("imageClick",c,a):e&&this._doClickOrTapAction("bgClick",c,a)}tap(b,a){didTapOnMainContent(a)&&this._doClickOrTapAction("tap",b,a)}doubleTap(b,a){didTapOnMainContent(a)&&this._doClickOrTapAction("doubleTap",b,a)}_doClickOrTapAction(e,c,f){let{pswp:a}=this.gestures,{currSlide:b}=a,d=a.options[e+"Action"];if(!a.dispatch(e+"Action",{point:c,originalEvent:f}).defaultPrevented){if("function"==typeof d){d.call(a,c,f);return}switch(d){case"close":case"next":a[d]();break;case"zoom":b.toggleZoom(c);break;case"zoom-or-close":b.isZoomable()&&b.zoomLevels.secondary!==b.zoomLevels.initial?b.toggleZoom(c):a.options.clickToCloseNonZoomable&&a.close();break;case"toggle-controls":this.gestures.pswp.element.classList.toggle("pswp--ui-visible")}}}}let AXIS_SWIPE_HYSTERISIS=10,DOUBLE_TAP_DELAY=300,MIN_TAP_DISTANCE=25;class Gestures{constructor(a){this.pswp=a,this.p1={},this.p2={},this.prevP1={},this.prevP2={},this.startP1={},this.startP2={},this.velocity={},this._lastStartP1={},this._intervalP1={},this._numActivePoints=0,this._ongoingPointers=[],this._touchEventEnabled="ontouchstart"in window,this._pointerEventEnabled=!!window.PointerEvent,this.supportsTouch=this._touchEventEnabled||this._pointerEventEnabled&&navigator.maxTouchPoints>1,this.supportsTouch||(a.options.allowPanToNext=!1),this.drag=new DragHandler(this),this.zoomLevels=new ZoomHandler(this),this.tapHandler=new TapHandler(this),a.on("bindEvents",()=>{a.events.add(a.scrollWrap,"click",a=>this._onClick(a)),this._pointerEventEnabled?this._bindEvents("pointer","down","up","cancel"):this._touchEventEnabled?(this._bindEvents("touch","start","end","cancel"),a.scrollWrap.ontouchmove=()=>{},a.scrollWrap.ontouchend=()=>{}):this._bindEvents("mouse","down","up")})}_bindEvents(a,f,g,d){let{pswp:c}=this,{events:b}=c,e=d?a+d:"";b.add(c.scrollWrap,a+f,this.onPointerDown.bind(this)),b.add(window,a+"move",this.onPointerMove.bind(this)),b.add(window,a+g,this.onPointerUp.bind(this)),e&&b.add(c.scrollWrap,e,this.onPointerUp.bind(this))}onPointerDown(a){let c;if(("mousedown"===a.type||"mouse"===a.pointerType)&&(c=!0),c&&a.button>0)return;let{pswp:b}=this;if(!b.opener.isOpen){a.preventDefault();return}b.dispatch("pointerDown",{originalEvent:a}).defaultPrevented||(c&&(b.mouseDetected(),this._preventPointerEventBehaviour(a)),b.animations.stopAll(),this._updatePoints(a,"down"),this.pointerDown=!0,1===this._numActivePoints&&(this.dragAxis=null,equalizePoints(this.startP1,this.p1)),this._numActivePoints>1?(this._clearTapTimer(),this.isMultitouch=!0):this.isMultitouch=!1)}onPointerMove(a){a.preventDefault(),this._numActivePoints&&(this._updatePoints(a,"move"),this.pswp.dispatch("pointerMove",{originalEvent:a}).defaultPrevented||(1!==this._numActivePoints||this.isDragging?this._numActivePoints>1&&!this.isZooming&&(this._finishDrag(),this.isZooming=!0,this._updateStartPoints(),this.zoomLevels.start(),this._rafStopLoop(),this._rafRenderLoop()):(this.dragAxis||this._calculateDragDirection(),this.dragAxis&&!this.isDragging&&(this.isZooming&&(this.isZooming=!1,this.zoomLevels.end()),this.isDragging=!0,this._clearTapTimer(),this._updateStartPoints(),this._intervalTime=Date.now(),this._velocityCalculated=!1,equalizePoints(this._intervalP1,this.p1),this.velocity.x=0,this.velocity.y=0,this.drag.start(),this._rafStopLoop(),this._rafRenderLoop()))))}_finishDrag(){this.isDragging&&(this.isDragging=!1,this._velocityCalculated||this._updateVelocity(!0),this.drag.end(),this.dragAxis=null)}onPointerUp(a){this._numActivePoints&&(this._updatePoints(a,"up"),!this.pswp.dispatch("pointerUp",{originalEvent:a}).defaultPrevented&&(0!==this._numActivePoints||(this.pointerDown=!1,this._rafStopLoop(),this.isDragging?this._finishDrag():this.isZooming||this.isMultitouch||this._finishTap(a)),this._numActivePoints<2&&this.isZooming&&(this.isZooming=!1,this.zoomLevels.end(),1===this._numActivePoints&&(this.dragAxis=null,this._updateStartPoints()))))}_rafRenderLoop(){(this.isDragging||this.isZooming)&&(this._updateVelocity(),this.isDragging?pointsEqual(this.p1,this.prevP1)||this.drag.change():pointsEqual(this.p1,this.prevP1)&&pointsEqual(this.p2,this.prevP2)||this.zoomLevels.change(),this._updatePrevPoints(),this.raf=requestAnimationFrame(this._rafRenderLoop.bind(this)))}_updateVelocity(c){let b=Date.now(),a=b-this._intervalTime;(!(a<50)||c)&&(this.velocity.x=this._getVelocity("x",a),this.velocity.y=this._getVelocity("y",a),this._intervalTime=b,equalizePoints(this._intervalP1,this.p1),this._velocityCalculated=!0)}_finishTap(a){let{mainScroll:b}=this.pswp;if(b.isShifted()){b.moveIndexBy(0,!0);return}if(a.type.indexOf("cancel")>0)return;if("mouseup"===a.type||"mouse"===a.pointerType){this.tapHandler.click(this.startP1,a);return}let c=this.pswp.options.doubleTapAction?300:0;this._tapTimer?(this._clearTapTimer(),25>getDistanceBetween(this._lastStartP1,this.startP1)&&this.tapHandler.doubleTap(this.startP1,a)):(equalizePoints(this._lastStartP1,this.startP1),this._tapTimer=setTimeout(()=>{this.tapHandler.tap(this.startP1,a),this._clearTapTimer()},c))}_clearTapTimer(){this._tapTimer&&(clearTimeout(this._tapTimer),this._tapTimer=null)}_getVelocity(a,b){let c=this.p1[a]-this._intervalP1[a];return Math.abs(c)>1&&b>5?c/b:0}_rafStopLoop(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}_preventPointerEventBehaviour(a){return a.preventDefault(),!0}_updatePoints(a,c){if(this._pointerEventEnabled){let b=this._ongoingPointers.findIndex(b=>b.id===a.pointerId);"up"===c&&b> -1?this._ongoingPointers.splice(b,1):"down"===c&& -1===b?this._ongoingPointers.push(this._convertEventPosToPoint(a,{})):b> -1&&this._convertEventPosToPoint(a,this._ongoingPointers[b]),this._numActivePoints=this._ongoingPointers.length,this._numActivePoints>0&&equalizePoints(this.p1,this._ongoingPointers[0]),this._numActivePoints>1&&equalizePoints(this.p2,this._ongoingPointers[1])}else this._numActivePoints=0,a.type.indexOf("touch")> -1?a.touches&&a.touches.length>0&&(this._convertEventPosToPoint(a.touches[0],this.p1),this._numActivePoints++,a.touches.length>1&&(this._convertEventPosToPoint(a.touches[1],this.p2),this._numActivePoints++)):(this._convertEventPosToPoint(a,this.p1),"up"===c?this._numActivePoints=0:this._numActivePoints++)}_updatePrevPoints(){equalizePoints(this.prevP1,this.p1),equalizePoints(this.prevP2,this.p2)}_updateStartPoints(){equalizePoints(this.startP1,this.p1),equalizePoints(this.startP2,this.p2),this._updatePrevPoints()}_calculateDragDirection(){if(this.pswp.mainScroll.isShifted())this.dragAxis="x";else{let b=Math.abs(this.p1.x-this.startP1.x)-Math.abs(this.p1.y-this.startP1.y);if(0!==b){let a=b>0?"x":"y";Math.abs(this.p1[a]-this.startP1[a])>=10&&(this.dragAxis=a)}}}_convertEventPosToPoint(a,b){return b.x=a.pageX-this.pswp.offset.x,b.y=a.pageY-this.pswp.offset.y,void 0!==a.pointerId?b.id=a.pointerId:void 0!==a.identifier&&(b.id=a.identifier),b}_onClick(a){this.pswp.mainScroll.isShifted()&&(a.preventDefault(),a.stopPropagation())}}let MAIN_SCROLL_END_FRICTION=.35;class MainScroll{constructor(a){this.pswp=a,this.x=0,this.resetPosition()}resize(d){let{pswp:a}=this,b=Math.round(a.viewportSize.x+a.viewportSize.x*a.options.spacing),c=b!==this.slideWidth;c&&(this.slideWidth=b,this.moveTo(this.getCurrSlideX())),this.itemHolders.forEach((a,b)=>{c&&setTransform(a.el,(b+this._containerShiftIndex)*this.slideWidth),d&&a.slide&&a.slide.resize()})}resetPosition(){this._currPositionIndex=0,this._prevPositionIndex=0,this.slideWidth=0,this._containerShiftIndex=-1}appendHolders(){this.itemHolders=[];for(let a=0;a<3;a++){let b=createElement("pswp__item",!1,this.pswp.container);b.style.display=1===a?"block":"none",this.itemHolders.push({el:b})}}canBeSwiped(){return this.pswp.getNumItems()>1}moveIndexBy(d,i,j){let{pswp:a}=this,c=a.potentialIndex+d,b=a.getNumItems();if(a.canLoop()){c=a.getLoopedIndex(c);let e=(d+b)%b;d=e<=b/2?e:e-b}else c<0?c=0:c>=b&&(c=b-1),d=c-a.potentialIndex;a.potentialIndex=c,this._currPositionIndex-=d,a.animations.stopMainScroll();let h=this.getCurrSlideX();if(i){a.animations.startSpring({isMainScroll:!0,start:this.x,end:h,velocity:j||0,naturalFrequency:30,dampingRatio:1,onUpdate:a=>{this.moveTo(a)},onComplete:()=>{this.updateCurrItem(),a.appendHeavy()}});let f=a.potentialIndex-a.currIndex;if(a.canLoop()){let g=(f+b)%b;f=g<=b/2?g:g-b}Math.abs(f)>1&&this.updateCurrItem()}else this.moveTo(h),this.updateCurrItem();if(d)return!0}getCurrSlideX(){return this.slideWidth*this._currPositionIndex}isShifted(){return this.x!==this.getCurrSlideX()}updateCurrItem(){let{pswp:a}=this,c=this._prevPositionIndex-this._currPositionIndex;if(!c)return;this._prevPositionIndex=this._currPositionIndex,a.currIndex=a.potentialIndex;let d=Math.abs(c),b;d>=3&&(this._containerShiftIndex+=c+(c>0?-3:3),d=3);for(let e=0;e<d;e++)c>0?(b=this.itemHolders.shift(),this.itemHolders[2]=b,this._containerShiftIndex++,setTransform(b.el,(this._containerShiftIndex+2)*this.slideWidth),a.setContent(b,a.currIndex-d+e+2)):(b=this.itemHolders.pop(),this.itemHolders.unshift(b),this._containerShiftIndex--,setTransform(b.el,this._containerShiftIndex*this.slideWidth),a.setContent(b,a.currIndex+d-e-2));Math.abs(this._containerShiftIndex)>50&&!this.isShifted()&&(this.resetPosition(),this.resize()),a.animations.stopAllPan(),this.itemHolders.forEach((a,b)=>{a.slide&&a.slide.setIsActive(1===b)}),a.currSlide=this.itemHolders[1].slide,a.contentLoader.updateLazy(c),a.currSlide.applyCurrentZoomPan(),a.dispatch("change")}moveTo(a,d){let b,c;!this.pswp.canLoop()&&d&&(b=(this.slideWidth*this._currPositionIndex-a)/this.slideWidth,b+=this.pswp.currIndex,c=Math.round(a-this.x),(b<0&&c>0||b>=this.pswp.getNumItems()-1&&c<0)&&(a=this.x+.35*c)),this.x=a,setTransform(this.pswp.container,a),this.pswp.dispatch("moveMainScroll",{x:a,dragging:d})}}class Keyboard{constructor(a){this.pswp=a,a.on("bindEvents",()=>{a.options.initialPointerPos||this._focusRoot(),a.events.add(document,"focusin",this._onFocusIn.bind(this)),a.events.add(document,"keydown",this._onKeyDown.bind(this))});let b=document.activeElement;a.on("destroy",()=>{a.options.returnFocus&&b&&this._wasFocused&&b.focus()})}_focusRoot(){this._wasFocused||(this.pswp.element.focus(),this._wasFocused=!0)}_onKeyDown(d){let{pswp:c}=this;if(c.dispatch("keydown",{originalEvent:d}).defaultPrevented||specialKeyUsed(d))return;let e,a,f;switch(d.keyCode){case 27:c.options.escKey&&(e="close");break;case 90:e="toggleZoom";break;case 37:a="x";break;case 38:a="y";break;case 39:a="x",f=!0;break;case 40:f=!0,a="y";break;case 9:this._focusRoot()}if(a){d.preventDefault();let{currSlide:b}=c;c.options.arrowKeys&&"x"===a&&c.getNumItems()>1?e=f?"next":"prev":b&&b.currZoomLevel>b.zoomLevels.fit&&(b.pan[a]+=f?-80:80,b.panTo(b.pan.x,b.pan.y))}e&&(d.preventDefault(),c[e]())}_onFocusIn(a){let{template:b}=this.pswp;document===a.target||b===a.target||b.contains(a.target)||b.focus()}}let DEFAULT_EASING="cubic-bezier(.4,0,.22,1)";class CSSAnimation{constructor(a){this.props=a;let{target:d,onComplete:e,transform:f}=a,{duration:b,easing:c}=a,g=f?"transform":"opacity",h=a[g];this._target=d,this._onComplete=e,b=b||333,c=c||"cubic-bezier(.4,0,.22,1)",this._onTransitionEnd=this._onTransitionEnd.bind(this),this._firstFrameTimeout=setTimeout(()=>{setTransitionStyle(d,g,b,c),this._firstFrameTimeout=setTimeout(()=>{d.addEventListener("transitionend",this._onTransitionEnd,!1),d.addEventListener("transitioncancel",this._onTransitionEnd,!1),d.style[g]=h},30)},0)}_onTransitionEnd(a){a.target===this._target&&this._finalizeAnimation()}_finalizeAnimation(){!this._finished&&(this._finished=!0,this.onFinish(),this._onComplete&&this._onComplete())}destroy(){this._firstFrameTimeout&&clearTimeout(this._firstFrameTimeout),removeTransitionStyle(this._target),this._target.removeEventListener("transitionend",this._onTransitionEnd,!1),this._target.removeEventListener("transitioncancel",this._onTransitionEnd,!1),this._finished||this._finalizeAnimation()}}let DEFAULT_NATURAL_FREQUENCY=12,DEFAULT_DAMPING_RATIO=.75;class SpringEaser{constructor(a,b,c){this.velocity=1e3*a,this._dampingRatio=b||.75,this._naturalFrequency=c||12,this._dampingRatio<1&&(this._dampedFrequency=this._naturalFrequency*Math.sqrt(1-this._dampingRatio*this._dampingRatio))}easeFrame(b,c){let d=0,a;c/=1e3;let e=Math.E**(-this._dampingRatio*this._naturalFrequency*c);if(1===this._dampingRatio)a=this.velocity+this._naturalFrequency*b,d=(b+a*c)*e,this.velocity=-(d*this._naturalFrequency)+a*e;else if(this._dampingRatio<1){a=1/this._dampedFrequency*(this._dampingRatio*this._naturalFrequency*b+this.velocity);let f=Math.cos(this._dampedFrequency*c),g=Math.sin(this._dampedFrequency*c);d=e*(b*f+a*g),this.velocity=-(d*this._naturalFrequency)*this._dampingRatio+e*(-this._dampedFrequency*b*g+this._dampedFrequency*a*f)}return d}}class SpringAnimation{constructor(a){this.props=a;let{start:b,end:c,velocity:d,onUpdate:i,onComplete:j,onFinish:e,dampingRatio:f,naturalFrequency:g}=a,k=new SpringEaser(d,f,g),l=Date.now(),m=b-c;this._onFinish=e;let h=()=>{this._raf&&(1>Math.abs(m=k.easeFrame(m,Date.now()-l))&&50>Math.abs(k.velocity)?(i(c),j&&j(),this.onFinish()):(l=Date.now(),i(m+c),this._raf=requestAnimationFrame(h)))};this._raf=requestAnimationFrame(h)}destroy(){this._raf>=0&&cancelAnimationFrame(this._raf),this._raf=null}}class Animations{constructor(){this.activeAnimations=[]}startSpring(a){this._start(a,!0)}startTransition(a){this._start(a)}_start(b,c){let a;return a=c?new SpringAnimation(b):new CSSAnimation(b),this.activeAnimations.push(a),a.onFinish=()=>this.stop(a),a}stop(a){a.destroy();let b=this.activeAnimations.indexOf(a);b> -1&&this.activeAnimations.splice(b,1)}stopAll(){this.activeAnimations.forEach(a=>{a.destroy()}),this.activeAnimations=[]}stopAllPan(){this.activeAnimations=this.activeAnimations.filter(a=>!a.props.isPan||(a.destroy(),!1))}stopMainScroll(){this.activeAnimations=this.activeAnimations.filter(a=>!a.props.isMainScroll||(a.destroy(),!1))}isPanRunning(){return this.activeAnimations.some(a=>a.props.isPan)}}class ScrollWheel{constructor(a){this.pswp=a,a.events.add(a.element,"wheel",this._onWheel.bind(this))}_onWheel(a){a.preventDefault();let{currSlide:b}=this.pswp,{deltaX:e,deltaY:d}=a;if(b&&!this.pswp.dispatch("wheel",{originalEvent:a}).defaultPrevented){if(a.ctrlKey||this.pswp.options.wheelToZoom){if(b.isZoomable()){let c=-d;1===a.deltaMode?c*=.05:c*=a.deltaMode?1:.002,c=2**c;let f=b.currZoomLevel*c;b.zoomTo(f,{x:a.clientX,y:a.clientY})}}else b.isPannable()&&(1===a.deltaMode&&(e*=18,d*=18),b.panTo(b.pan.x-e,b.pan.y-d))}}}function addElementHTML(b){if("string"==typeof b)return b;if(!b||!b.isCustomSVG)return"";let c=b,a='<svg aria-hidden="true" class="pswp__icn" viewBox="0 0 %d %d" width="%d" height="%d">';return a=a.split("%d").join(c.size||32),c.outlineID&&(a+='<use class="pswp__icn-shadow" xlink:href="#'+c.outlineID+'"/>'),a+=c.inner,a+="</svg>",a}class UIElement{constructor(b,a){let d=a.name||a.className,h=a.html;if(!1===b.options[d])return;"string"==typeof b.options[d+"SVG"]&&(h=b.options[d+"SVG"]),b.dispatch("uiElementCreate",{data:a});let e="";a.isButton?(e+="pswp__button ",e+=a.className||`pswp__button--${a.name}`):e+=a.className||`pswp__${a.name}`;let c,f=a.isButton?a.tagName||"button":a.tagName||"div";c=createElement(e,f=f.toLowerCase()),a.isButton&&(c=createElement(e,f),"button"===f&&(c.type="button"),"string"==typeof b.options[d+"Title"]?c.title=b.options[d+"Title"]:a.title&&(c.title=a.title)),c.innerHTML=addElementHTML(h),a.onInit&&a.onInit(c,b),a.onClick&&(c.onclick=d=>{"string"==typeof a.onClick?b[a.onClick]():a.onClick(d,c,b)});let i=a.appendTo||"bar",g;"bar"===i?(b.topBar||(b.topBar=createElement("pswp__top-bar pswp__hide-on-close",!1,b.scrollWrap)),g=b.topBar):(c.classList.add("pswp__hide-on-close"),g="wrapper"===i?b.scrollWrap:b.element),g.appendChild(c)}}function initArrowButton(a,b,c){a.classList.add("pswp__button--arrow"),b.on("change",()=>{b.options.loop||(c?a.disabled=!(b.currIndex<b.getNumItems()-1):a.disabled=!(b.currIndex>0))})}let arrowPrev={name:"arrowPrev",className:"pswp__button--arrow--prev",title:"Previous",order:10,isButton:!0,appendTo:"wrapper",html:{isCustomSVG:!0,size:60,inner:'<path d="M29 43l-3 3-16-16 16-16 3 3-13 13 13 13z" id="pswp__icn-arrow"/>',outlineID:"pswp__icn-arrow"},onClick:"prev",onInit:initArrowButton},arrowNext={name:"arrowNext",className:"pswp__button--arrow--next",title:"Next",order:11,isButton:!0,appendTo:"wrapper",html:{isCustomSVG:!0,size:60,inner:'<use xlink:href="#pswp__icn-arrow"/>',outlineID:"pswp__icn-arrow"},onClick:"next",onInit(a,b){initArrowButton(a,b,!0)}},closeButton={name:"close",title:"Close",order:20,isButton:!0,html:{isCustomSVG:!0,inner:'<path d="M24 10l-2-2-6 6-6-6-2 2 6 6-6 6 2 2 6-6 6 6 2-2-6-6z" id="pswp__icn-close"/>',outlineID:"pswp__icn-close"},onClick:"close"},zoomButton={name:"zoom",title:"Zoom",order:10,isButton:!0,html:{isCustomSVG:!0,inner:'<path d="M17.426 19.926a6 6 0 1 1 1.5-1.5L23 22.5 21.5 24l-4.074-4.074z" id="pswp__icn-zoom"/><path fill="currentColor" class="pswp__zoom-icn-bar-h" d="M11 16v-2h6v2z"/><path fill="currentColor" class="pswp__zoom-icn-bar-v" d="M13 12h2v6h-2z"/>',outlineID:"pswp__icn-zoom"},onClick:"toggleZoom"},loadingIndicator={name:"preloader",appendTo:"bar",order:7,html:{isCustomSVG:!0,inner:'<path fill-rule="evenodd" clip-rule="evenodd" d="M21.2 16a5.2 5.2 0 1 1-5.2-5.2V8a8 8 0 1 0 8 8h-2.8Z" id="pswp__icn-loading"/>',outlineID:"pswp__icn-loading"},onInit(c,a){let d,e,f=(a,b)=>{c.classList[b?"add":"remove"]("pswp__preloader--"+a)},g=a=>{d!==a&&(d=a,f("active",a))},b=()=>{if(!a.currSlide.content.isLoading()){g(!1),e&&(clearTimeout(e),e=null);return}e||(e=setTimeout(()=>{g(a.currSlide.content.isLoading()),e=null},a.options.preloaderDelay))};a.on("change",b),a.on("loadComplete",c=>{a.currSlide===c.slide&&b()}),a.ui.updatePreloaderVisibility=b}},counterIndicator={name:"counter",order:5,onInit(b,a){a.on("change",()=>{b.innerText=a.currIndex+1+a.options.indexIndicatorSep+a.getNumItems()})}};function setZoomedIn(a,b){a.classList[b?"add":"remove"]("pswp--zoomed-in")}class UI{constructor(a){this.pswp=a}init(){let{pswp:a}=this;this.isRegistered=!1,this.uiElementsData=[closeButton,arrowPrev,arrowNext,zoomButton,loadingIndicator,counterIndicator],a.dispatch("uiRegister"),this.uiElementsData.sort((a,b)=>(a.order||0)-(b.order||0)),this.items=[],this.isRegistered=!0,this.uiElementsData.forEach(a=>{this.registerElement(a)}),a.on("change",()=>{a.element.classList[1===a.getNumItems()?"add":"remove"]("pswp--one-slide")}),a.on("zoomPanUpdate",()=>this._onZoomPanUpdate())}registerElement(a){this.isRegistered?this.items.push(new UIElement(this.pswp,a)):this.uiElementsData.push(a)}_onZoomPanUpdate(){let{template:a,currSlide:b,options:d}=this.pswp,{currZoomLevel:c}=b;if(this.pswp.opener.isClosing||(this.pswp.opener.isOpen||(c=b.zoomLevels.initial),c===this._lastUpdatedZoomLevel))return;this._lastUpdatedZoomLevel=c;let e=b.zoomLevels.initial-b.zoomLevels.secondary;if(.01>Math.abs(e)||!b.isZoomable()){setZoomedIn(a,!1),a.classList.remove("pswp--zoom-allowed");return}a.classList.add("pswp--zoom-allowed"),c===b.zoomLevels.secondary?setZoomedIn(a,e<0):c>b.zoomLevels.secondary?setZoomedIn(a,!0):setZoomedIn(a,!1),("zoom"===d.imageClickAction||"zoom-or-close"===d.imageClickAction)&&a.classList.add("pswp--click-to-zoom")}}function getBoundsByElement(b){let a=b.getBoundingClientRect();return{x:a.left,y:a.top,w:a.width}}function getCroppedBoundsByElement(j,b,d){let a=j.getBoundingClientRect(),e=a.width/b,f=a.height/d,c=e>f?e:f,g=(a.width-b*c)/2,h=(a.height-d*c)/2,i={x:a.left+g,y:a.top+h,w:b*c};return i.innerRect={w:a.width,h:a.height,x:g,y:h},i}function getThumbBounds(e,a,b){let f=b.dispatch("thumbBounds",{index:e,itemData:a,instance:b});if(f.thumbBounds)return f.thumbBounds;let{element:d}=a,g,c;if(d&& !1!==b.options.thumbSelector){let h=b.options.thumbSelector||"img";c=d.matches(h)?d:d.querySelector(h)}return(c=b.applyFilters("thumbEl",c,a,e))&&(g=a.thumbCropped?getCroppedBoundsByElement(c,a.w,a.h):getBoundsByElement(c)),b.applyFilters("thumbBounds",g,a,e)}class PhotoSwipeEvent{constructor(b,a){this.type=b,a&&Object.assign(this,a)}preventDefault(){this.defaultPrevented=!0}}class Eventable{constructor(){this._listeners={},this._filters={}}addFilter(a,b,c=100){this._filters[a]||(this._filters[a]=[]),this._filters[a].push({fn:b,priority:c}),this._filters[a].sort((a,b)=>a.priority-b.priority),this.pswp&&this.pswp.addFilter(a,b,c)}removeFilter(a,b){this._filters[a]&&(this._filters[a]=this._filters[a].filter(a=>a.fn!==b)),this.pswp&&this.pswp.removeFilter(a,b)}applyFilters(a,...b){return this._filters[a]&&this._filters[a].forEach(a=>{b[0]=a.fn.apply(this,b)}),b[0]}on(a,b){this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(b),this.pswp&&this.pswp.on(a,b)}off(a,b){this._listeners[a]&&(this._listeners[a]=this._listeners[a].filter(a=>b!==a)),this.pswp&&this.pswp.off(a,b)}dispatch(a,b){if(this.pswp)return this.pswp.dispatch(a,b);let c=new PhotoSwipeEvent(a,b);return this._listeners&&this._listeners[a]&&this._listeners[a].forEach(a=>{a.call(this,c)}),c}}class Placeholder{constructor(a,b){this.element=createElement("pswp__img pswp__img--placeholder",a?"img":"",b),a&&(this.element.decoding="async",this.element.alt="",this.element.src=a,this.element.setAttribute("role","presentation")),this.element.setAttribute("aria-hiden","true")}setDisplayedSize(a,b){this.element&&("IMG"===this.element.tagName?(setWidthHeight(this.element,250,"auto"),this.element.style.transformOrigin="0 0",this.element.style.transform=toTransformString(0,0,a/250)):setWidthHeight(this.element,a,b))}destroy(){this.element.parentNode&&this.element.remove(),this.element=null}}class Content{constructor(a,b,c){this.instance=b,this.data=a,this.index=c,this.width=Number(this.data.w)||Number(this.data.width)||0,this.height=Number(this.data.h)||Number(this.data.height)||0,this.isAttached=!1,this.hasSlide=!1,this.state=LOAD_STATE.IDLE,this.data.type?this.type=this.data.type:this.data.src?this.type="image":this.type="html",this.instance.dispatch("contentInit",{content:this})}removePlaceholder(){this.placeholder&&!this.keepPlaceholder()&&setTimeout(()=>{this.placeholder&&(this.placeholder.destroy(),this.placeholder=null)},500)}load(a,b){if(!this.placeholder&&this.slide&&this.usePlaceholder()){let c=this.instance.applyFilters("placeholderSrc",!!this.data.msrc&&!!this.slide.isFirstSlide&&this.data.msrc,this);this.placeholder=new Placeholder(c,this.slide.container)}(!this.element||b)&&!this.instance.dispatch("contentLoad",{content:this,isLazy:a}).defaultPrevented&&(this.isImageContent()?this.loadImage(a):(this.element=createElement("pswp__content"),this.element.innerHTML=this.data.html||""),b&&this.slide&&this.slide.updateContentSize(!0))}loadImage(a){this.element=createElement("pswp__img","img"),this.instance.dispatch("contentLoadImage",{content:this,isLazy:a}).defaultPrevented||(this.data.srcset&&(this.element.srcset=this.data.srcset),this.element.src=this.data.src,this.element.alt=this.data.alt||"",this.state=LOAD_STATE.LOADING,this.element.complete?this.onLoaded():(this.element.onload=()=>{this.onLoaded()},this.element.onerror=()=>{this.onError()}))}setSlide(a){this.slide=a,this.hasSlide=!0,this.instance=a.pswp}onLoaded(){this.state=LOAD_STATE.LOADED,this.slide&&(this.instance.dispatch("loadComplete",{slide:this.slide,content:this}),this.slide.isActive&&this.slide.heavyAppended&&!this.element.parentNode&&(this.slide.container.innerHTML="",this.append(),this.slide.updateContentSize(!0)))}onError(){this.state=LOAD_STATE.ERROR,this.slide&&(this.displayError(),this.instance.dispatch("loadComplete",{slide:this.slide,isError:!0,content:this}),this.instance.dispatch("loadError",{slide:this.slide,content:this}))}isLoading(){return this.instance.applyFilters("isContentLoading",this.state===LOAD_STATE.LOADING,this)}isError(){return this.state===LOAD_STATE.ERROR}isImageContent(){return"image"===this.type}setDisplayedSize(a,c){if(this.element&&(this.placeholder&&this.placeholder.setDisplayedSize(a,c),!this.instance.dispatch("contentResize",{content:this,width:a,height:c}).defaultPrevented&&(setWidthHeight(this.element,a,c),this.isImageContent()&&!this.isError()))){let b=this.element;b.srcset&&(!b.dataset.largestUsedSize||a>b.dataset.largestUsedSize)&&(b.sizes=a+"px",b.dataset.largestUsedSize=a),this.slide&&this.instance.dispatch("imageSizeChange",{slide:this.slide,width:a,height:c,content:this})}}isZoomable(){return this.instance.applyFilters("isContentZoomable",this.isImageContent()&&this.state!==LOAD_STATE.ERROR,this)}usePlaceholder(){return this.instance.applyFilters("useContentPlaceholder",this.isImageContent(),this)}lazyLoad(){this.instance.dispatch("contentLazyLoad",{content:this}).defaultPrevented||this.load(!0)}keepPlaceholder(){return this.instance.applyFilters("isKeepingPlaceholder",this.isLoading(),this)}destroy(){this.hasSlide=!1,this.slide=null,!this.instance.dispatch("contentDestroy",{content:this}).defaultPrevented&&(this.remove(),this.isImageContent()&&this.element&&(this.element.onload=null,this.element.onerror=null,this.element=null))}displayError(){if(this.slide){let a=createElement("pswp__error-msg");a.innerText=this.instance.options.errorMsg,a=this.instance.applyFilters("contentErrorElement",a,this),this.element=createElement("pswp__content pswp__error-msg-container"),this.element.appendChild(a),this.slide.container.innerHTML="",this.slide.container.appendChild(this.element),this.slide.updateContentSize(!0),this.removePlaceholder()}}append(){if(this.isAttached=!0,this.state===LOAD_STATE.ERROR){this.displayError();return}this.instance.dispatch("contentAppend",{content:this}).defaultPrevented||(this.isImageContent()?this.slide&&!this.slide.isActive&&"decode"in this.element?(this.isDecoding=!0,requestAnimationFrame(()=>{this.element&&"IMG"===this.element.tagName&&this.element.decode().then(()=>{this.isDecoding=!1,requestAnimationFrame(()=>{this.appendImage()})}).catch(()=>{this.isDecoding=!1})})):(this.placeholder&&(this.state===LOAD_STATE.LOADED||this.state===LOAD_STATE.ERROR)&&this.removePlaceholder(),this.appendImage()):this.element&&!this.element.parentNode&&this.slide.container.appendChild(this.element))}activate(){!this.instance.dispatch("contentActivate",{content:this}).defaultPrevented&&this.slide&&(this.isImageContent()&&this.isDecoding?this.appendImage():this.isError()&&this.load(!1,!0))}deactivate(){this.instance.dispatch("contentDeactivate",{content:this})}remove(){this.isAttached=!1,!this.instance.dispatch("contentRemove",{content:this}).defaultPrevented&&this.element&&this.element.parentNode&&this.element.remove()}appendImage(){this.isAttached&&!this.instance.dispatch("contentAppendImage",{content:this}).defaultPrevented&&this.slide&&this.element&&!this.element.parentNode&&(this.slide.container.appendChild(this.element),this.placeholder&&(this.state===LOAD_STATE.LOADED||this.state===LOAD_STATE.ERROR)&&this.removePlaceholder())}}class PhotoSwipeBase extends Eventable{getNumItems(){let b,{dataSource:a}=this.options;a?a.length?b=a.length:a.gallery&&(a.items||(a.items=this._getGalleryDOMElements(a.gallery)),a.items&&(b=a.items.length)):b=0;let c=this.dispatch("numItems",{dataSource:a,numItems:b});return this.applyFilters("numItems",c.numItems,a)}createContentFromData(a,b){return new Content(a,this,b)}getItemData(b){let{dataSource:a}=this.options,d;Array.isArray(a)?d=a[b]:a&&a.gallery&&(a.items||(a.items=this._getGalleryDOMElements(a.gallery)),d=a.items[b]);let c=d;c instanceof Element&&(c=this._domElementToItemData(c));let e=this.dispatch("itemData",{itemData:c||{},index:b});return this.applyFilters("itemData",e.itemData,b)}_getGalleryDOMElements(a){return this.options.children||this.options.childSelector?getElementsFromOption(this.options.children,this.options.childSelector,a)||[]:[a]}_domElementToItemData(c){let a={element:c},b="A"===c.tagName?c:c.querySelector("a");if(b){a.src=b.dataset.pswpSrc||b.href,b.dataset.pswpSrcset&&(a.srcset=b.dataset.pswpSrcset),a.width=parseInt(b.dataset.pswpWidth,10),a.height=parseInt(b.dataset.pswpHeight,10),a.w=a.width,a.h=a.height,b.dataset.pswpType&&(a.type=b.dataset.pswpType);let d=c.querySelector("img");d&&(a.msrc=d.currentSrc||d.src,a.alt=d.getAttribute("alt")),(b.dataset.pswpCropped||b.dataset.cropped)&&(a.thumbCropped=!0)}return this.applyFilters("domItemData",a,c,b),a}}let MIN_OPACITY=.003;class Opener{constructor(a){this.pswp=a,this.isClosed=!0,this._prepareOpen=this._prepareOpen.bind(this),a.on("firstZoomPan",this._prepareOpen)}open(){this._prepareOpen(),this._start()}close(){if(this.isClosed||this.isClosing||this.isOpening)return!1;let a=this.pswp.currSlide;return this.isOpen=!1,this.isOpening=!1,this.isClosing=!0,this._duration=this.pswp.options.hideAnimationDuration,a&&a.currZoomLevel*a.width>=this.pswp.options.maxWidthToAnimate&&(this._duration=0),this._applyStartProps(),setTimeout(()=>{this._start()},this._croppedZoom?30:0),!0}_prepareOpen(){if(this.pswp.off("firstZoomPan",this._prepareOpen),!this.isOpening){let a=this.pswp.currSlide;this.isOpening=!0,this.isClosing=!1,this._duration=this.pswp.options.showAnimationDuration,a&&a.zoomLevels.initial*a.width>=this.pswp.options.maxWidthToAnimate&&(this._duration=0),this._applyStartProps()}}_applyStartProps(){let{pswp:a}=this,b=this.pswp.currSlide,{options:c}=a;if("fade"===c.showHideAnimationType?(c.showHideOpacity=!0,this._thumbBounds=!1):"none"===c.showHideAnimationType?(c.showHideOpacity=!1,this._duration=0,this._thumbBounds=!1):this.isOpening&&a._initialThumbBounds?this._thumbBounds=a._initialThumbBounds:this._thumbBounds=this.pswp.getThumbBounds(),this._placeholder=b.getPlaceholderElement(),a.animations.stopAll(),this._useAnimation=this._duration>50,this._animateZoom=Boolean(this._thumbBounds)&&b.content&&b.content.usePlaceholder()&&(!this.isClosing||!a.mainScroll.isShifted()),this._animateZoom?this._animateRootOpacity=c.showHideOpacity:(this._animateRootOpacity=!0,this.isOpening&&(b.zoomAndPanToInitial(),b.applyCurrentZoomPan())),this._animateBgOpacity=!this._animateRootOpacity&&this.pswp.options.bgOpacity>.003,this._opacityElement=this._animateRootOpacity?a.element:a.bg,!this._useAnimation){this._duration=0,this._animateZoom=!1,this._animateBgOpacity=!1,this._animateRootOpacity=!0,this.isOpening&&(a.element.style.opacity=.003,a.applyBgOpacity(1));return}this._animateZoom&&this._thumbBounds.innerRect?(this._croppedZoom=!0,this._cropContainer1=this.pswp.container,this._cropContainer2=this.pswp.currSlide.holderElement,a.container.style.overflow="hidden",a.container.style.width=a.viewportSize.x+"px"):this._croppedZoom=!1,this.isOpening?(this._animateRootOpacity?(a.element.style.opacity=.003,a.applyBgOpacity(1)):(this._animateBgOpacity&&(a.bg.style.opacity=.003),a.element.style.opacity=1),this._animateZoom&&(this._setClosedStateZoomPan(),this._placeholder&&(this._placeholder.willChange="transform",this._placeholder.style.opacity=.003))):this.isClosing&&(a.mainScroll.itemHolders[0].el.style.display="none",a.mainScroll.itemHolders[2].el.style.display="none",this._croppedZoom&&0!==a.mainScroll.x&&(a.mainScroll.resetPosition(),a.mainScroll.resize()))}_start(){this.isOpening&&this._useAnimation&&this._placeholder&&"IMG"===this._placeholder.tagName?new Promise(a=>{let b=!1,c=!0;decodeImage(this._placeholder).finally(()=>{b=!0,c||a()}),setTimeout(()=>{c=!1,b&&a()},50),setTimeout(a,250)}).finally(()=>this._initiate()):this._initiate()}_initiate(){this.pswp.element.style.setProperty("--pswp-transition-duration",this._duration+"ms"),this.pswp.dispatch(this.isOpening?"openingAnimationStart":"closingAnimationStart"),this.pswp.dispatch("initialZoom"+(this.isOpening?"In":"Out")),this.pswp.element.classList[this.isOpening?"add":"remove"]("pswp--ui-visible"),this.isOpening?(this._placeholder&&(this._placeholder.style.opacity=1),this._animateToOpenState()):this.isClosing&&this._animateToClosedState(),this._useAnimation||this._onAnimationComplete()}_onAnimationComplete(){let{pswp:a}=this;this.isOpen=this.isOpening,this.isClosed=this.isClosing,this.isOpening=!1,this.isClosing=!1,a.dispatch(this.isOpen?"openingAnimationEnd":"closingAnimationEnd"),a.dispatch("initialZoom"+(this.isOpen?"InEnd":"OutEnd")),this.isClosed?a.destroy():this.isOpen&&(this._animateZoom&&(a.container.style.overflow="visible",a.container.style.width="100%"),a.currSlide.applyCurrentZoomPan())}_animateToOpenState(){let{pswp:a}=this;this._animateZoom&&(this._croppedZoom&&(this._animateTo(this._cropContainer1,"transform","translate3d(0,0,0)"),this._animateTo(this._cropContainer2,"transform","none")),a.currSlide.zoomAndPanToInitial(),this._animateTo(a.currSlide.container,"transform",a.currSlide.getCurrentTransform())),this._animateBgOpacity&&this._animateTo(a.bg,"opacity",a.options.bgOpacity),this._animateRootOpacity&&this._animateTo(a.element,"opacity",1)}_animateToClosedState(){let{pswp:a}=this;this._animateZoom&&this._setClosedStateZoomPan(!0),this._animateBgOpacity&&a.bgOpacity>.01&&this._animateTo(a.bg,"opacity",0),this._animateRootOpacity&&this._animateTo(a.element,"opacity",0)}_setClosedStateZoomPan(d){let{pswp:i}=this,{innerRect:a}=this._thumbBounds,{currSlide:b,viewportSize:c}=i;if(this._croppedZoom){let e=-c.x+(this._thumbBounds.x-a.x)+a.w,f=-c.y+(this._thumbBounds.y-a.y)+a.h,g=c.x-a.w,h=c.y-a.h;d?(this._animateTo(this._cropContainer1,"transform",toTransformString(e,f)),this._animateTo(this._cropContainer2,"transform",toTransformString(g,h))):(setTransform(this._cropContainer1,e,f),setTransform(this._cropContainer2,g,h))}equalizePoints(b.pan,a||this._thumbBounds),b.currZoomLevel=this._thumbBounds.w/b.width,d?this._animateTo(b.container,"transform",b.getCurrentTransform()):b.applyCurrentZoomPan()}_animateTo(a,b,c){if(!this._duration){a.style[b]=c;return}let{animations:e}=this.pswp,d={duration:this._duration,easing:this.pswp.options.easing,onComplete:()=>{e.activeAnimations.length||this._onAnimationComplete()},target:a};d[b]=c,e.startTransition(d)}}let MIN_SLIDES_TO_CACHE=5;function lazyLoadData(b,c,f){let a=c.createContentFromData(b,f);if(!a||!a.lazyLoad)return;let{options:d}=c,g=c.viewportSize||getViewportSize(d),h=getPanAreaSize(d,g,b,f),e=new ZoomLevel(d,b,-1);return e.update(a.width,a.height,h),a.lazyLoad(),a.setDisplayedSize(Math.ceil(a.width*e.initial),Math.ceil(a.height*e.initial)),a}function lazyLoadSlide(a,b){let c=b.getItemData(a);if(!b.dispatch("lazyLoadSlide",{index:a,itemData:c}).defaultPrevented)return lazyLoadData(c,b,a)}class ContentLoader{constructor(a){this.pswp=a,this.limit=Math.max(a.options.preload[0]+a.options.preload[1]+1,5),this._cachedItems=[]}updateLazy(c){let{pswp:b}=this;if(b.dispatch("lazyLoad").defaultPrevented)return;let{preload:d}=b.options,e=void 0===c||c>=0,a;for(a=0;a<=d[1];a++)this.loadSlideByIndex(b.currIndex+(e?a:-a));for(a=1;a<=d[0];a++)this.loadSlideByIndex(b.currIndex+(e?-a:a))}loadSlideByIndex(a){a=this.pswp.getLoopedIndex(a);let b=this.getContentByIndex(a);!b&&(b=lazyLoadSlide(a,this.pswp))&&this.addToCache(b)}getContentBySlide(b){let a=this.getContentByIndex(b.index);return!a&&(a=this.pswp.createContentFromData(b.data,b.index))&&this.addToCache(a),a&&a.setSlide(b),a}addToCache(a){if(this.removeByIndex(a.index),this._cachedItems.push(a),this._cachedItems.length>this.limit){let b=this._cachedItems.findIndex(a=>!a.isAttached&&!a.hasSlide);if(-1!==b){let c=this._cachedItems.splice(b,1)[0];c.destroy()}}}removeByIndex(b){let a=this._cachedItems.findIndex(a=>a.index===b);-1!==a&&this._cachedItems.splice(a,1)}getContentByIndex(a){return this._cachedItems.find(b=>b.index===a)}destroy(){this._cachedItems.forEach(a=>a.destroy()),this._cachedItems=null}}let defaultOptions={allowPanToNext:!0,spacing:.1,loop:!0,pinchToClose:!0,closeOnVerticalDrag:!0,hideAnimationDuration:333,showAnimationDuration:333,zoomAnimationDuration:333,escKey:!0,arrowKeys:!0,returnFocus:!0,maxWidthToAnimate:4e3,clickToCloseNonZoomable:!0,imageClickAction:"zoom-or-close",bgClickAction:"close",tapAction:"toggle-controls",doubleTapAction:"zoom",indexIndicatorSep:" / ",preloaderDelay:2e3,bgOpacity:.8,index:0,errorMsg:"The image cannot be loaded",preload:[1,2],easing:"cubic-bezier(.4,0,.22,1)"};class PhotoSwipe extends PhotoSwipeBase{constructor(a){super(),this._prepareOptions(a),this.offset={},this._prevViewportSize={},this.viewportSize={},this.bgOpacity=1,this.events=new DOMEvents,this.animations=new Animations,this.mainScroll=new MainScroll(this),this.gestures=new Gestures(this),this.opener=new Opener(this),this.keyboard=new Keyboard(this),this.contentLoader=new ContentLoader(this)}init(){if(this.isOpen||this.isDestroying)return;this.isOpen=!0,this.dispatch("init"),this.dispatch("beforeOpen"),this._createMainStructure();let a="pswp--open";return this.gestures.supportsTouch&&(a+=" pswp--touch"),this.options.mainClass&&(a+=" "+this.options.mainClass),this.element.className+=" "+a,this.currIndex=this.options.index||0,this.potentialIndex=this.currIndex,this.dispatch("firstUpdate"),this.scrollWheel=new ScrollWheel(this),(Number.isNaN(this.currIndex)||this.currIndex<0||this.currIndex>=this.getNumItems())&&(this.currIndex=0),this.gestures.supportsTouch||this.mouseDetected(),this.updateSize(),this.offset.y=window.pageYOffset,this._initialItemData=this.getItemData(this.currIndex),this.dispatch("gettingData",this.currIndex,this._initialItemData,!0),this._initialThumbBounds=this.getThumbBounds(),this.dispatch("initialLayout"),this.on("openingAnimationEnd",()=>{this.setContent(this.mainScroll.itemHolders[0],this.currIndex-1),this.setContent(this.mainScroll.itemHolders[2],this.currIndex+1),this.mainScroll.itemHolders[0].el.style.display="block",this.mainScroll.itemHolders[2].el.style.display="block",this.appendHeavy(),this.contentLoader.updateLazy(),this.events.add(window,"resize",this._handlePageResize.bind(this)),this.events.add(window,"scroll",this._updatePageScrollOffset.bind(this)),this.dispatch("bindEvents")}),this.setContent(this.mainScroll.itemHolders[1],this.currIndex),this.dispatch("change"),this.opener.open(),this.dispatch("afterInit"),!0}getLoopedIndex(a){let b=this.getNumItems();return this.options.loop&&(a>b-1&&(a-=b),a<0&&(a+=b)),a=clamp(a,0,b-1)}appendHeavy(){this.mainScroll.itemHolders.forEach(a=>{a.slide&&a.slide.appendHeavy()})}goTo(a){this.mainScroll.moveIndexBy(this.getLoopedIndex(a)-this.potentialIndex)}next(){this.goTo(this.potentialIndex+1)}prev(){this.goTo(this.potentialIndex-1)}zoomTo(...a){this.currSlide.zoomTo(...a)}toggleZoom(){this.currSlide.toggleZoom()}close(){this.opener.isOpen&&!this.isDestroying&&(this.isDestroying=!0,this.dispatch("close"),this.events.removeAll(),this.opener.close())}destroy(){if(!this.isDestroying){this.options.showHideAnimationType="none",this.close();return}this.dispatch("destroy"),this.listeners=null,this.scrollWrap.ontouchmove=null,this.scrollWrap.ontouchend=null,this.element.remove(),this.mainScroll.itemHolders.forEach(a=>{a.slide&&a.slide.destroy()}),this.contentLoader.destroy(),this.events.removeAll()}refreshSlideContent(a){this.contentLoader.removeByIndex(a),this.mainScroll.itemHolders.forEach((b,d)=>{let c=this.currSlide.index-1+d;this.canLoop()&&(c=this.getLoopedIndex(c)),c===a&&(this.setContent(b,a,!0),1===d&&(this.currSlide=b.slide,b.slide.setIsActive(!0)))}),this.dispatch("change")}setContent(a,b,c){if(this.canLoop()&&(b=this.getLoopedIndex(b)),a.slide){if(a.slide.index===b&&!c)return;a.slide.destroy(),a.slide=null}if(!this.canLoop()&&(b<0||b>=this.getNumItems()))return;let d=this.getItemData(b);a.slide=new Slide(d,b,this),b===this.currIndex&&(this.currSlide=a.slide),a.slide.append(a.el)}getViewportCenterPoint(){return{x:this.viewportSize.x/2,y:this.viewportSize.y/2}}updateSize(b){if(this.isDestroying)return;let a=getViewportSize(this.options,this);!b&&pointsEqual(a,this._prevViewportSize)||(equalizePoints(this._prevViewportSize,a),this.dispatch("beforeResize"),equalizePoints(this.viewportSize,this._prevViewportSize),this._updatePageScrollOffset(),this.dispatch("viewportSize"),this.mainScroll.resize(this.opener.isOpen),!this.hasMouse&&window.matchMedia("(any-hover: hover)").matches&&this.mouseDetected(),this.dispatch("resize"))}applyBgOpacity(a){this.bgOpacity=Math.max(a,0),this.bg.style.opacity=this.bgOpacity*this.options.bgOpacity}mouseDetected(){this.hasMouse||(this.hasMouse=!0,this.element.classList.add("pswp--has_mouse"))}_handlePageResize(){this.updateSize(),/iPhone|iPad|iPod/i.test(window.navigator.userAgent)&&setTimeout(()=>{this.updateSize()},500)}_updatePageScrollOffset(){this.setScrollOffset(0,window.pageYOffset)}setScrollOffset(a,b){this.offset.x=a,this.offset.y=b,this.dispatch("updateScrollOffset")}_createMainStructure(){this.element=createElement("pswp"),this.element.setAttribute("tabindex",-1),this.element.setAttribute("role","dialog"),this.template=this.element,this.bg=createElement("pswp__bg",!1,this.element),this.scrollWrap=createElement("pswp__scroll-wrap",!1,this.element),this.container=createElement("pswp__container",!1,this.scrollWrap),this.mainScroll.appendHolders(),this.ui=new UI(this),this.ui.init(),(this.options.appendToEl||document.body).appendChild(this.element)}getThumbBounds(){return getThumbBounds(this.currIndex,this.currSlide?this.currSlide.data:this._initialItemData,this)}canLoop(){return this.options.loop&&this.getNumItems()>2}_prepareOptions(a){window.matchMedia("(prefers-reduced-motion), (update: slow)").matches&&(a.showHideAnimationType="none",a.zoomAnimationDuration=0),this.options={...defaultOptions,...a}}}export default PhotoSwipe
