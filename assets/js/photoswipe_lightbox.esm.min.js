// From https://github.com/dimsemenov/PhotoSwipe

/*!
  * PhotoSwipe Lightbox 5.2.8 - https://photoswipe.com
  * (c) 2022 Dmytro Semenov
  */
function t(f,j,g){let b=document.createElement(j||"div");return f&&(b.className=f),g&&g.appendChild(b),b}function i(g,b,f){g.style.width="number"==typeof b?b+"px":b,g.style.height="number"==typeof f?f+"px":f}let s="idle",h="loading",e="loaded",n="error";function o(b,j,k=document){let f=[];if(b instanceof Element)f=[b];else if(b instanceof NodeList||Array.isArray(b))f=Array.from(b);else{let g="string"==typeof b?b:j;g&&(f=Array.from(k.querySelectorAll(g)))}return f}class r{constructor(f,b){this.type=f,b&&Object.assign(this,b)}preventDefault(){this.defaultPrevented=!0}}class a{constructor(b,f){this.element=t("pswp__img pswp__img--placeholder",b?"img":"",f),b&&(this.element.decoding="async",this.element.alt="",this.element.src=b,this.element.setAttribute("role","presentation")),this.element.setAttribute("aria-hiden","true")}setDisplayedSize(b,j){var f;let g;this.element&&("IMG"===this.element.tagName?(i(this.element,250,"auto"),this.element.style.transformOrigin="0 0",this.element.style.transform=(g="translate3d(0px,0px,0)",g+=" scale3d("+(f=b/250)+","+f+",1)")):i(this.element,b,j))}destroy(){this.element.parentNode&&this.element.remove(),this.element=null}}class c{constructor(b,f,g){this.instance=f,this.data=b,this.index=g,this.element=void 0,this.width=Number(this.data.w)||Number(this.data.width)||0,this.height=Number(this.data.h)||Number(this.data.height)||0,this.isAttached=!1,this.hasSlide=!1,this.state="idle",this.data.type?this.type=this.data.type:this.data.src?this.type="image":this.type="html",this.instance.dispatch("contentInit",{content:this})}removePlaceholder(){this.placeholder&&!this.keepPlaceholder()&&setTimeout(()=>{this.placeholder&&(this.placeholder.destroy(),this.placeholder=null)},500)}load(b,f){if(!this.placeholder&&this.slide&&this.usePlaceholder()){let g=this.instance.applyFilters("placeholderSrc",!(!this.data.msrc||!this.slide.isFirstSlide)&&this.data.msrc,this);this.placeholder=new a(g,this.slide.container)}this.element&&!f||this.instance.dispatch("contentLoad",{content:this,isLazy:b}).defaultPrevented||(this.isImageContent()?this.loadImage(b):(this.element=t("pswp__content"),this.element.innerHTML=this.data.html||""),f&&this.slide&&this.slide.updateContentSize(!0))}loadImage(f){let b=t("pswp__img","img");this.element=b,this.instance.dispatch("contentLoadImage",{content:this,isLazy:f}).defaultPrevented||(this.data.srcset&&(b.srcset=this.data.srcset),b.src=this.data.src,b.alt=this.data.alt||"",this.state=h,b.complete?this.onLoaded():(b.onload=()=>{this.onLoaded()},b.onerror=()=>{this.onError()}))}setSlide(b){this.slide=b,this.hasSlide=!0,this.instance=b.pswp}onLoaded(){this.state=e,this.slide&&(this.instance.dispatch("loadComplete",{slide:this.slide,content:this}),this.slide.isActive&&this.slide.heavyAppended&&!this.element.parentNode&&(this.slide.container.innerHTML="",this.append(),this.slide.updateContentSize(!0)))}onError(){this.state=n,this.slide&&(this.displayError(),this.instance.dispatch("loadComplete",{slide:this.slide,isError:!0,content:this}),this.instance.dispatch("loadError",{slide:this.slide,content:this}))}isLoading(){return this.instance.applyFilters("isContentLoading",this.state===h,this)}isError(){return this.state===n}isImageContent(){return"image"===this.type}setDisplayedSize(b,g){if(this.element&&(this.placeholder&&this.placeholder.setDisplayedSize(b,g),!this.instance.dispatch("contentResize",{content:this,width:b,height:g}).defaultPrevented&&(i(this.element,b,g),this.isImageContent()&&!this.isError()))){let f=this.element;f.srcset&&(!f.dataset.largestUsedSize||b>parseInt(f.dataset.largestUsedSize,10))&&(f.sizes=b+"px",f.dataset.largestUsedSize=String(b)),this.slide&&this.instance.dispatch("imageSizeChange",{slide:this.slide,width:b,height:g,content:this})}}isZoomable(){return this.instance.applyFilters("isContentZoomable",this.isImageContent()&&this.state!==n,this)}usePlaceholder(){return this.instance.applyFilters("useContentPlaceholder",this.isImageContent(),this)}lazyLoad(){this.instance.dispatch("contentLazyLoad",{content:this}).defaultPrevented||this.load(!0)}keepPlaceholder(){return this.instance.applyFilters("isKeepingPlaceholder",this.isLoading(),this)}destroy(){this.hasSlide=!1,this.slide=null,this.instance.dispatch("contentDestroy",{content:this}).defaultPrevented||(this.remove(),this.isImageContent()&&this.element&&(this.element.onload=null,this.element.onerror=null,this.element=null))}displayError(){if(this.slide){let b=t("pswp__error-msg");b.innerText=this.instance.options.errorMsg,b=this.instance.applyFilters("contentErrorElement",b,this),this.element=t("pswp__content pswp__error-msg-container"),this.element.appendChild(b),this.slide.container.innerHTML="",this.slide.container.appendChild(this.element),this.slide.updateContentSize(!0),this.removePlaceholder()}}append(){this.isAttached=!0,this.state!==n?this.instance.dispatch("contentAppend",{content:this}).defaultPrevented||(this.isImageContent()?this.slide&&!this.slide.isActive&&"decode"in this.element?(this.isDecoding=!0,requestAnimationFrame(()=>{this.element&&"IMG"===this.element.tagName&&this.element.decode().then(()=>{this.isDecoding=!1,requestAnimationFrame(()=>{this.appendImage()})}).catch(()=>{this.isDecoding=!1})})):(this.placeholder&&(this.state===e||this.state===n)&&this.removePlaceholder(),this.appendImage()):this.element&&!this.element.parentNode&&this.slide.container.appendChild(this.element)):this.displayError()}activate(){this.instance.dispatch("contentActivate",{content:this}).defaultPrevented||this.slide&&(this.isImageContent()&&this.isDecoding?this.appendImage():this.isError()&&this.load(!1,!0))}deactivate(){this.instance.dispatch("contentDeactivate",{content:this})}remove(){this.isAttached=!1,this.instance.dispatch("contentRemove",{content:this}).defaultPrevented||this.element&&this.element.parentNode&&this.element.remove()}appendImage(){this.isAttached&&(this.instance.dispatch("contentAppendImage",{content:this}).defaultPrevented||this.slide&&this.element&&!this.element.parentNode&&(this.slide.container.appendChild(this.element),this.placeholder&&(this.state===e||this.state===n)&&this.removePlaceholder()))}}function l(f,b,k,p,q){let g;if(b.paddingFn)g=b.paddingFn(k,p,q)[f];else if(b.padding)g=b.padding[f];else{let j="padding"+f[0].toUpperCase()+f.slice(1);b[j]&&(g=b[j])}return g||0}class u{constructor(b,f,g,j){this.pswp=j,this.options=b,this.itemData=f,this.index=g}update(g,j,k){this.elementSize={x:g,y:j},this.panAreaSize=k;let f=this.panAreaSize.x/this.elementSize.x,b=this.panAreaSize.y/this.elementSize.y;this.fit=Math.min(1,f<b?f:b),this.fill=Math.min(1,f>b?f:b),this.vFill=Math.min(1,b),this.initial=this.t(),this.secondary=this.i(),this.max=Math.max(this.initial,this.secondary,this.o()),this.min=Math.min(this.fit,this.initial,this.secondary),this.pswp&&this.pswp.dispatch("zoomLevelsUpdate",{zoomLevels:this,slideData:this.itemData})}l(f){let b=this.options[f+"ZoomLevel"];if(b)return"function"==typeof b?b(this):"fill"===b?this.fill:"fit"===b?this.fit:Number(b)}i(){let b=this.l("secondary");return b||((b=Math.min(1,3*this.fit))*this.elementSize.x>4e3&&(b=4e3/this.elementSize.x),b)}t(){return this.l("initial")||this.fit}o(){let b=this.l("max");return b||Math.max(1,4*this.fit)}}function d(q,p,x){var g,f,j,k;let b=p.createContentFromData(q,x);if(!b||!b.lazyLoad)return;let{options:v}=p,y=p.viewportSize||function(b,g){if(b.getViewportSizeFn){let f=b.getViewportSizeFn(b,g);if(f)return f}return{x:document.documentElement.clientWidth,y:window.innerHeight}}(v,p),z=(g=v,f=y,j=q,k=x,{x:f.x-l("left",g,f,j,k)-l("right",g,f,j,k),y:f.y-l("top",g,f,j,k)-l("bottom",g,f,j,k)}),w=new u(v,q,-1);return w.update(b.width,b.height,z),b.lazyLoad(),b.setDisplayedSize(Math.ceil(b.width*w.initial),Math.ceil(b.height*w.initial)),b}class m extends class extends class{constructor(){this.u={},this.m={},this.pswp=void 0,this.options=void 0}addFilter(b,f,g=100){this.m[b]||(this.m[b]=[]),this.m[b].push({fn:f,priority:g}),this.m[b].sort((b,f)=>b.priority-f.priority),this.pswp&&this.pswp.addFilter(b,f,g)}removeFilter(b,f){this.m[b]&&(this.m[b]=this.m[b].filter(b=>b.fn!==f)),this.pswp&&this.pswp.removeFilter(b,f)}applyFilters(b,...f){return this.m[b]&&this.m[b].forEach(b=>{f[0]=b.fn.apply(this,f)}),f[0]}on(b,f){this.u[b]||(this.u[b]=[]),this.u[b].push(f),this.pswp&&this.pswp.on(b,f)}off(b,f){this.u[b]&&(this.u[b]=this.u[b].filter(b=>f!==b)),this.pswp&&this.pswp.off(b,f)}dispatch(b,f){if(this.pswp)return this.pswp.dispatch(b,f);let g=new r(b,f);return this.u&&this.u[b]&&this.u[b].forEach(b=>{b.call(this,g)}),g}}{getNumItems(){let f,{dataSource:b}=this.options;b?"length"in b?f=b.length:"gallery"in b&&(b.items||(b.items=this.p(b.gallery)),b.items&&(f=b.items.length)):f=0;let g=this.dispatch("numItems",{dataSource:b,numItems:f});return this.applyFilters("numItems",g.numItems,b)}createContentFromData(b,f){return new c(b,this,f)}getItemData(f){let{dataSource:b}=this.options,j;Array.isArray(b)?j=b[f]:b&&b.gallery&&(b.items||(b.items=this.p(b.gallery)),j=b.items[f]);let g=j;g instanceof Element&&(g=this.g(g));let k=this.dispatch("itemData",{itemData:g||{},index:f});return this.applyFilters("itemData",k.itemData,f)}p(b){return this.options.children||this.options.childSelector?o(this.options.children,this.options.childSelector,b)||[]:[b]}g(g){let b={element:g},f="A"===g.tagName?g:g.querySelector("a");if(f){b.src=f.dataset.pswpSrc||f.href,f.dataset.pswpSrcset&&(b.srcset=f.dataset.pswpSrcset),b.width=parseInt(f.dataset.pswpWidth,10),b.height=parseInt(f.dataset.pswpHeight,10),b.w=b.width,b.h=b.height,f.dataset.pswpType&&(b.type=f.dataset.pswpType);let j=g.querySelector("img");j&&(b.msrc=j.currentSrc||j.src,b.alt=j.getAttribute("alt")),(f.dataset.pswpCropped||f.dataset.cropped)&&(b.thumbCropped=!0)}return this.applyFilters("domItemData",b,g,f)}}{constructor(b){super(),this.options=b||{},this.I=0}init(){this.onThumbnailsClick=this.onThumbnailsClick.bind(this),o(this.options.gallery,this.options.gallerySelector).forEach(b=>{b.addEventListener("click",this.onThumbnailsClick,!1)})}onThumbnailsClick(b){if(function(b){if(2===b.which||b.ctrlKey||b.metaKey||b.altKey||b.shiftKey)return!0}(b)||window.pswp|| !1===window.navigator.onLine)return;let f={x:b.clientX,y:b.clientY};f.x||f.y||(f=null);let g=this.getClickedIndex(b);g=this.applyFilters("clickedIndex",g,b,this);let j={gallery:b.currentTarget};g>=0&&(b.preventDefault(),this.loadAndOpen(g,j,f))}getClickedIndex(b){if(this.options.getClickedIndexFn)return this.options.getClickedIndexFn.call(this,b);let g=b.target,f=o(this.options.children,this.options.childSelector,b.currentTarget).findIndex(b=>b===g||b.contains(g));return -1!==f?f:this.options.children||this.options.childSelector?-1:0}loadAndOpen(b,f,g){return!window.pswp&&(this.options.index=b,this.options.initialPointerPos=g,this.shouldOpen=!0,this.preload(b,f),!0)}preload(j,k){var g;let{options:b}=this;k&&(b.dataSource=k);let f=[],p=typeof b.pswpModule;if("function"==typeof(g=b.pswpModule)&&g.prototype&&g.prototype.goTo)f.push(Promise.resolve(b.pswpModule));else{if("string"===p)throw new Error("pswpModule as string is no longer supported");if("function"!==p)throw new Error("pswpModule is not valid");f.push(b.pswpModule())}"function"==typeof b.openPromise&&f.push(b.openPromise()),!1!==b.preloadFirstSlide&&j>=0&&(this._=function(b,f){let g=f.getItemData(b);if(!f.dispatch("lazyLoadSlide",{index:b,itemData:g}).defaultPrevented)return d(g,f,b)}(j,this));let q=++this.I;Promise.all(f).then(b=>{if(this.shouldOpen){let f=b[0];this.v(f,q)}})}v(f,g){if(g!==this.I&&this.shouldOpen||(this.shouldOpen=!1,window.pswp))return;let b="object"==typeof f?new f.default(this.options):new f(this.options);this.pswp=b,window.pswp=b,Object.keys(this.u).forEach(f=>{this.u[f].forEach(g=>{b.on(f,g)})}),Object.keys(this.m).forEach(f=>{this.m[f].forEach(g=>{b.addFilter(f,g.fn,g.priority)})}),this._&&(b.contentLoader.addToCache(this._),this._=null),b.on("destroy",()=>{this.pswp=null,window.pswp=null}),b.init()}destroy(){this.pswp&&this.pswp.destroy(),this.shouldOpen=!1,this.u=null,o(this.options.gallery,this.options.gallerySelector).forEach(b=>{b.removeEventListener("click",this.onThumbnailsClick,!1)})}}export{m as default}
